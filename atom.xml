<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[始终]]></title>
  <subtitle><![CDATA[不忘初心]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://liam0205.me/"/>
  <updated>2015-04-30T04:42:56.489Z</updated>
  <id>http://liam0205.me/</id>
  
  <author>
    <name><![CDATA[Liam Huang]]></name>
    <email><![CDATA[liamhuang0205+blog@gmail.com]]></email>
  </author>
  
  <generator uri="http://zespia.tw/hexo/">Hexo</generator>
  
  <entry>
    <title><![CDATA[在 Git 中 Checkout 历史版本]]></title>
    <link href="http://liam0205.me/2015/04/29/git-checkout-history-version/"/>
    <id>http://liam0205.me/2015/04/29/git-checkout-history-version/</id>
    <published>2015-04-29T00:44:56.000Z</published>
    <updated>2015-04-29T01:59:31.000Z</updated>
    <content type="html"><![CDATA[<p>昨天写代码的时候，误删了一个文件。今天发现的时候，commit 已经 push 到版本库了。本想用 <code>git reset</code> 回退版本，找回文件后重新提交。但是想起 Git 是一个版本控制系统哎，直接从版本库里 checkout 出某个文件的历史版本不就好了？</p>
<p>想法挺好，但是很久没用这个功能，自己已经不记得具体的命令了。于是查了下手册，把和 checkout 历史版本有关的几个命令都记录一下。</p>
<a id="more"></a>

<h3 id=" 从某个历史版本创建新的分支 ">从某个历史版本创建新的分支</h3>
<p>在 Git 中从当前分支创建并检出新分支的命令是</p>
<pre><code>git checkout <span class="attribute">-b</span> name<span class="attribute">-of</span><span class="attribute">-new</span><span class="attribute">-branch</span>
</code></pre><p>这个命令实际上是</p>
<pre><code>git checkout <span class="attribute">-b</span> name<span class="attribute">-of</span><span class="attribute">-new</span><span class="attribute">-branch</span> current<span class="attribute">-branch</span>
</code></pre><p>的简写形式。也就是说，当我们不指定 checkout 起点时，Git 默认从当前活动分支开始创建新的分支。</p>
<p>Git 的每个提交都有一个 SHA1 散列值（Hash 值）作为 ID。我们可以在 <code>checkout</code> 命令中使用这些 ID 作为起点。比如：</p>
<pre><code>git checkout <span class="attribute">-b</span> name<span class="attribute">-of</span><span class="attribute">-new</span><span class="attribute">-branch</span> <span class="number">169</span>d2dc
</code></pre><p>这样，Git 的活动分支会切换到 <code>name-of-new-branch</code> 这个分支上，而它的内容与 <code>169d2dc</code> 这个分支一致。</p>
<p>注意：SHA1 的散列值有 40 个字母，相当长。所以 Git 允许我们在不引起歧义的情况下，使用散列值的前几位作为缩写。</p>
<p>提示：你也可以用 <code>git branch name-of-new-branch 169d2dc</code> 来创建一个历史分支，而不切换到该分支。</p>
<h3 id=" 将某个历史版本 _checkout_ 到工作区 ">将某个历史版本 checkout 到工作区</h3>
<p>首先说明，这样做会产生一个分离的 HEAD 指针，所以个人不推荐这么做。</p>
<p>如果我们工作在 <code>master</code> 分支上，希望 checkout 到 <code>dev</code> 分支上，我们会这么做：</p>
<pre><code>git checkout dev
</code></pre><p>这里 <code>dev</code> 实际上是一个指针的别名，其本质也是一个 SHA1 散列值。所以，我们很自然地可以用</p>
<pre><code>git checkout <span class="subst">&lt;</span>sha1<span class="attribute">-of</span><span class="attribute">-a</span><span class="attribute">-commit</span><span class="subst">&gt;</span>
</code></pre><p>将某个历史版本 checkout 到工作区。</p>
<h3 id=" 将某个文件的历史版本 _checkout_ 到工作区 ">将某个文件的历史版本 checkout 到工作区</h3>
<p>大多数时候，我们可能只需要对某一个文件做细小的修补，因此只 checkout 该文件就行了，并不需要操作整个 commit 或分支。</p>
<p>上一节我们介绍了如何将某个历史版本完整地 checkout 到工作区。实际上，我们只需要在上一节的命令之后加上需要 checkout 的文件即可。</p>
<pre><code>git checkout &lt;sha1-<span class="operator">of</span>-<span class="operator">a</span>-commit&gt; &lt;/path/<span class="built_in">to</span>/your/<span class="built_in">file</span>&gt;
</code></pre><p>当然，有时候你需要将某个文件的历史版本 checkout 出来，并以一个新的名字保存。这时候可以这么做：</p>
<pre><code>git checkout &lt;sha1-of-a-commit&gt;<span class="symbol">:&lt;/path/to/your/file&gt;</span> &lt;<span class="regexp">/new/name</span><span class="regexp">/of/the</span><span class="regexp">/file&gt;</span>
</code></pre>]]></content>
    <summary type="html"><![CDATA[<p>昨天写代码的时候，误删了一个文件。今天发现的时候，commit 已经 push 到版本库了。本想用 <code>git reset</code> 回退版本，找回文件后重新提交。但是想起 Git 是一个版本控制系统哎，直接从版本库里 checkout 出某个文件的历史版本不就好了？</p>
<p>想法挺好，但是很久没用这个功能，自己已经不记得具体的命令了。于是查了下手册，把和 checkout 历史版本有关的几个命令都记录一下。</p>
]]></summary>
    
      <category term="Git" scheme="http://liam0205.me/tags/Git/"/>
    
      <category term="IT" scheme="http://liam0205.me/categories/IT/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Apple 词典·再要你命 3000 | 美国传统大辞典 | Merriam Webster Collegiate Dict]]></title>
    <link href="http://liam0205.me/2015/04/24/apple-dictionaries-download/"/>
    <id>http://liam0205.me/2015/04/24/apple-dictionaries-download/</id>
    <published>2015-04-24T03:14:08.000Z</published>
    <updated>2015-04-28T23:42:40.000Z</updated>
    <content type="html"><![CDATA[<p>Apple 为 OS X 设计的词典非常好用，在不进行任何配置的情况下，就可以在全系统范围内进行选词查询。遗憾的是，Apple 并没有为用户提供太多可选的词典。</p>
<p>我用 Python 写了一个程序，将 Babylon 词典软件的 BGL 格式，转换为 Apple Dictionaries 的格式。由于 Babylon 的词典众多，于是 Apple 自带的词典也就多了起来。</p>
<a id="more"></a>

<p>这里转换好的有五个词典：</p>
<ul>
<li>再要你命 3000</li>
<li>美国传统大词典 英汉双解版</li>
<li>柯林斯高阶英汉双解学习词典</li>
<li>美林韦氏大学词典</li>
<li>英汉数学名词词典</li>
<li>英语用法词典</li>
</ul>
<p>下载后，将 ZIP 归档解包，将得到的 .dictionary 文件（实际上是文件夹）移动到下列目录：</p>
<pre><code>~<span class="regexp">/Library/</span><span class="constant">Dictionaries</span>
</code></pre><p>打开系统里的词典程序，在配置中，就能看到新增的词典了。</p>
<p>下载链接: <a href="http://pan.baidu.com/s/1gdIgK0b" target="_blank">http://pan.baidu.com/s/1gdIgK0b</a><br>提取密码: nsp0</p>
<p>文章已转载至知乎：<a href="http://www.zhihu.com/question/27098318/answer/46110189" target="_blank">http://www.zhihu.com/question/27098318/answer/46110189</a></p>
]]></content>
    <summary type="html"><![CDATA[<p>Apple 为 OS X 设计的词典非常好用，在不进行任何配置的情况下，就可以在全系统范围内进行选词查询。遗憾的是，Apple 并没有为用户提供太多可选的词典。</p>
<p>我用 Python 写了一个程序，将 Babylon 词典软件的 BGL 格式，转换为 Apple Dictionaries 的格式。由于 Babylon 的词典众多，于是 Apple 自带的词典也就多了起来。</p>
]]></summary>
    
      <category term="3000" scheme="http://liam0205.me/tags/3000/"/>
    
      <category term="AHD" scheme="http://liam0205.me/tags/AHD/"/>
    
      <category term="Merriam Webster" scheme="http://liam0205.me/tags/Merriam%20Webster/"/>
    
      <category term="Apple Dictionaries" scheme="http://liam0205.me/tags/Apple%20Dictionaries/"/>
    
      <category term="GRE" scheme="http://liam0205.me/categories/GRE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[PIL 简明教程 - 基本用法]]></title>
    <link href="http://liam0205.me/2015/04/22/pil-tutorial-basic-usage/"/>
    <id>http://liam0205.me/2015/04/22/pil-tutorial-basic-usage/</id>
    <published>2015-04-22T09:46:31.000Z</published>
    <updated>2015-04-23T15:15:08.000Z</updated>
    <content type="html"><![CDATA[<p>PIL (Python Image Library) 是 Python 平台处理图片的事实标准，兼具强大的功能和简洁的 API。这篇文章将从 PIL 的安装开始，介绍 PIL 的基本情况和基本用法。</p>
<a id="more"></a>

<h2 id=" 安装 ">安装</h2>
<p>在安装好了 Python 的基础上，安装 Python 十分简单。在 *nix 系统里，可以直接使用 Python 的包管理器来安装。例如使用 <code>easy_install</code> 安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="built_in">sudo</span> easy_install PIL
</pre></td></tr></table></figure>



<p>在 Windows 系统里，可以直接安装 <code>.exe</code> 版本。你可以在 <a href="http://pythonware.com/products/pil/" target="_blank">PIL 的官网</a> 下载到它。</p>
<p>安装好之后，打开 Python 解释器，输入 <code>import Image</code> 来测试是否安装成功。</p>
<h2 id=" 新建一个 _Image_ 类的实例 ">新建一个 <code>Image</code> 类的实例</h2>
<p>PIL 的主要功能定义在 <code>Image</code> 类当中，而 <code>Image</code> 类定义在同名的 <code>Image</code> 模块当中。使用 PIL 的功能，一般都是从新建一个 <code>Image</code> 类的实例开始。新建 <code>Image</code> 类的实例有多种方法。你可以用 <code>Image</code> 模块的 <code>open()</code> 函数打开已有的图片档案，也可以处理其它的实例，或者从零开始构建一个实例。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="keyword">import</span> Image
sourceFileName = <span class="string">"source.png"</span>
avatar         = Image.open(sourceFileName)
</pre></td></tr></table></figure>



<p>上述代码引入了 Image 模块，并以 <code>open()</code> 方法打开了 <code>source.png</code> 这个图像，构建了名为 <code>avatar</code> 的实例。如果打开失败，则会抛出 <code>IOError</code> 异常。</p>
<p>接下来你可以使用 <code>show()</code> 方法来查看实例。注意，PIL 会将实例暂存为一个临时文件，而后打开它。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>avatar.show()
</pre></td></tr></table></figure>



<p><img src="/attachment/images/Python/pil-tutorial/Image_show.png" alt=" 使用 `show()` 方法查看实例的内容 "></p>
<h2 id=" 查看实例的属性 ">查看实例的属性</h2>
<p><code>Image</code> 类的实例有 5 个属性，分别是：</p>
<ul>
<li><code>format</code>: 以 <code>string</code> 返回图片档案的格式（<code>JPG</code>, <code>PNG</code>, <code>BMP</code>, <code>None</code>, etc.）；如果不是从打开文件得到的实例，则返回 <code>None</code>。</li>
<li><code>mode</code>: 以 <code>string</code> 返回图片的模式（RGB, CMYK, etc.）；完整的列表参见 <a href="http://effbot.org/imagingbook/concepts.htm#mode" target="_blank">官方说明·图片模式列表</a></li>
<li><code>size</code>: 以二元 tuple 返回图片档案的尺寸 (width, height)</li>
<li><code>palette</code>: 仅当 <code>mode</code> 为 <code>P</code> 时有效，返回 <code>ImagePalette</code> 示例</li>
<li><code>info</code>: 以字典形式返回示例的信息</li>
</ul>
<p>我们接着上面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="keyword">print</span> avatar.format, avatar.size, avatar.mode
</pre></td></tr></table></figure>



<p><img src="/attachment/images/Python/pil-tutorial/Image_attrib.png" alt=" 查看示例的属性 "></p>
<p>这里我们看到返回了图片的格式 <code>PNG</code>、图片的大小 <code>(400, 400)</code> 和图片的模式 <code>RGB</code>。</p>
<h2 id=" 实例的方法 ">实例的方法</h2>
<p><code>Image</code> 类定义了许多方法，这里无法一一列出（也无必要）。如果有需要，可以参看 <a href="http://effbot.org/imagingbook/image.htm" target="_blank">官方说明·<code>Image</code> 模块</a>。这里仅列出几个有趣的应用。</p>
<h3 id=" 图片 _IO_-_ 转换图片格式 ">图片 IO - 转换图片格式</h3>
<p><code>Image</code> 模块提供了 <code>open()</code> 函数打开图片档案，<code>Image</code> 类则提供了 <code>save()</code> 方法将图片实例保存为图片档案。</p>
<p><code>save()</code> 函数可以以特定的图片格式保存图片档案。比如 <code>save(&#39;target.jpg&#39;, &#39;JPG&#39;)</code> 将会以 <code>JPG</code> 格式将图片示例保存为 <code>target.jpg</code>。不过，大多数时候也可以省略图片格式。此时，<code>save()</code> 方法会根据文件扩展名来选择相应的图片格式。</p>
<p>我们以一个转换图片格式的脚本进行分析。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="keyword">import</span> os, sys
<span class="keyword">import</span> Image

<span class="keyword">for</span> infile <span class="keyword">in</span> sys.argv[<span class="number">1</span>:]:
    f, e = os.path.splitext(infile)
    outfile = f + <span class="string">".jpg"</span>
    <span class="keyword">if</span> infile != outfile:
        <span class="keyword">try</span>:
            Image.open(infile).save(outfile)
        <span class="keyword">except</span> IOError:
            <span class="keyword">print</span> <span class="string">"cannot convert"</span>, infile
</pre></td></tr></table></figure>



<p>这里，<code>f</code> 是除去扩展名之外的文件名。在 <code>try</code> 语句中，我们尝试打开图片档案，然后以 <code>.jpg</code> 为扩展名保存图片档案。<code>save()</code> 方法会根据扩展名，将图片以 <code>JPG</code> 格式保存为档案。如果图片档案无法打开，则在终端上打印无法转换的消息。</p>
<h3 id=" 制作缩略图 ">制作缩略图</h3>
<p><code>Image</code> 类的 <code>thumbnail()</code> 方法可以用来制作缩略图。它接受一个二元数组作为缩略图的尺寸，然后将示例缩小到指定尺寸。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre><span class="keyword">import</span> os, sys
<span class="keyword">import</span> Image

<span class="keyword">for</span> infile <span class="keyword">in</span> sys.argv[<span class="number">1</span>:]:
    outfile = os.path.splitext(infile)[<span class="number">0</span>] + <span class="string">".thumbnail"</span>
    <span class="keyword">if</span> infile != outfile:
        <span class="keyword">try</span>:
            im   = Image.open(infile)
            x, y = im.size
            im.thumbnail((x//<span class="number">2</span>, y//<span class="number">2</span>))
            im.save(outfile, <span class="string">"JPEG"</span>)
        <span class="keyword">except</span> IOError:
            <span class="keyword">print</span> <span class="string">"cannot create thumbnail for"</span>, infile
</pre></td></tr></table></figure>



<p>这里我们用 <code>im.size</code> 获取原图档的尺寸，然后以 <code>thumbnail()</code> 制作缩略图，大小则是原先图档的四分之一。同样，如果图档无法打开，则在终端上打印无法执行的提示。</p>
<h3 id=" 剪裁图档 ">剪裁图档</h3>
<p>以前也写过 <a href="http://liam0205.me/2014/01/27/Py-Incise-Images/">一篇博客</a>，讲述如何用 PIL 批量剪裁图档，供参考。</p>
<h3 id=" 变形与粘贴 ">变形与粘贴</h3>
<p><code>transpose()</code> 方法可以将图片左右颠倒、上下颠倒、旋转 90°、旋转 180° 或旋转 270°。<code>paste()</code> 方法则可以将一个 <code>Image</code> 示例粘贴到另一个 <code>Image</code> 示例上。</p>
<p>我们尝试将一张图片的左半部分截取下来，左右颠倒之后旋转 180°；将图片的右半边不作更改粘贴到左半部分；最后将修改过的左半部分粘贴到右半部分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="code"><pre><span class="keyword">import</span> Image

imageFName = <span class="string">'source.png'</span>

<span class="function"><span class="keyword">def</span> <span class="title">iamge_transpose</span><span class="params">(image)</span>:</span>
    <span class="string">'''
        Input: a Image instance
        Output: a transposed Image instance
        Function:
            * switches the left and the right part of a Image instance
            * for the left part of the original instance, flips left and right\
                and then make it upside down.
    '''</span>
    xsize, ysize = image.size
    xsizeLeft    = xsize // <span class="number">2</span> <span class="comment"># while xsizeRight = xsize - xsizeLeft</span>

    boxLeft      = (<span class="number">0</span>, <span class="number">0</span>, xsizeLeft, ysize)
    boxRight     = (xsizeLeft, <span class="number">0</span>, xsize, ysize)
    boxLeftNew   = (<span class="number">0</span>, <span class="number">0</span>, xsize - xsizeLeft, ysize)
    boxRightNew  = (xsize - xsizeLeft, <span class="number">0</span>, xsize, ysize)

    partLeft     = image.crop(boxLeft).transpose(Image.FLIP_LEFT_RIGHT).\
        transpose(Image.ROTATE_180)
    partRight    = image.crop(boxRight)

    image.paste(partRight, boxLeftNew)
    image.paste(partLeft, boxRightNew)
    <span class="keyword">return</span> image

avatar = Image.open(imageFName)
avatar = iamge_transpose(avatar)
avatar.show()
</pre></td></tr></table></figure>



<p><code>image_transpose()</code> 函数定义之前的部分很简单，而函数本身也由文档叙述得比较清楚。</p>
<p>这里我们以 <code>xsize</code> 和 <code>ysize</code> 接收图片的宽和高，然后以 <code>xsizeLeft</code> 计算得到左半边图片的大小。需要注意的是，我们构建了四个元组，并命名为盒子。这个盒子用直角坐标的值在 <code>image</code> 的画布上框定了一个区域。注意，<code>Image</code> 模块以图片的左上角为直角坐标原点，向右为 <code>x</code> 轴正方向，向下为 <code>y</code> 轴正方向。元组中的前两个数，代表区域左上角的坐标值；后两个数代表区域右下角的坐标值。</p>
<p>接下来的代码相当易懂。我们先用 <code>crop()</code> 方法将原图 <code>boxLeft</code> 的区域（也就是原图的左半边）切下来，然后用 <code>transpose()</code> 方法先后进行左右颠倒和旋转 180° 的工作，并最周公将它保存在 <code>partLeft</code> 这个实例中。而 <code>partRight</code> 的操作更为简单。</p>
<p>函数的最后，我们用 <code>paste()</code> 方法，将前两步得到的 <code>partLeft</code> 和 <code>partRight</code> 分别粘贴到指定的区域；并最终返回 <code>image</code> 示例。</p>
<p>代码片段的最后，我们用 <code>show()</code> 方法展示图片。</p>
<p><img src="/attachment/images/Python/pil-tutorial/transpose_paste.png" alt=" 变形和旋转 "></p>
]]></content>
    <summary type="html"><![CDATA[<p>PIL (Python Image Library) 是 Python 平台处理图片的事实标准，兼具强大的功能和简洁的 API。这篇文章将从 PIL 的安装开始，介绍 PIL 的基本情况和基本用法。</p>
]]></summary>
    
      <category term="Python" scheme="http://liam0205.me/tags/Python/"/>
    
      <category term="PIL" scheme="http://liam0205.me/tags/PIL/"/>
    
      <category term="Image" scheme="http://liam0205.me/tags/Image/"/>
    
      <category term="IT" scheme="http://liam0205.me/categories/IT/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[避免 \chapter 命令分页]]></title>
    <link href="http://liam0205.me/2015/04/22/cancle-clearpage-in-chapter/"/>
    <id>http://liam0205.me/2015/04/22/cancle-clearpage-in-chapter/</id>
    <published>2015-04-22T01:39:26.000Z</published>
    <updated>2015-04-22T02:14:27.000Z</updated>
    <content type="html"><![CDATA[<p>LaTeX 的 <code>book</code> 类中，<code>\chapter</code> 命令用来标记章节。在生成的 PDF 文稿中，<code>\chapter</code> 总是另起一页；在打开（默认）<code>openright</code> 选项的时候，可能还会空白一页。在实际使用过程中，很多人希望 <code>\chapter</code> 不要换页，紧接着当前页的内容排版。</p>
<p>传统工具没有提供此功能，因此用户需要自行修改 <code>\chapter</code> 的定义。</p>
<a id="more"></a>

<h2 id=" 找到 _\chapter_ 的定义 ">找到 <code>\chapter</code> 的定义</h2>
<p>LaTeX 标准文档类的定义写在 <code>classes.pdf</code> 这个文档中，你可以在命令行下使用 <code>texdoc classes</code> 来打开这份文档。</p>
<p>你可以在文档的 7.2.6 节中找到 <code>\chapter</code> 的定义。和我们的问题相关的，就是 <code>\chapter</code> 定义的第一行。</p>
<p><img src="/images/LaTeX/def-of-chapter.png" alt="`\chapter` 的定义 "></p>
<p>得益于 <a href="http://liam0205.me/2015/01/23/literate-programming-in-latex/">文学编程</a>，我们看到文档中明确地写着「章节总是应该从新的一页开始，因此我们需要调用 <code>\clearpage</code>」。</p>
<p>显然，为了达到目的，我么只需要令 <code>\chapter</code> 定义的第一行失效就好了。</p>
<h2 id=" 打补丁 ">打补丁</h2>
<p><code>xpatch</code> 宏包可以用来打补丁。它的 <code>\xpatchcmd</code> 命令接受五个参数：<code>\xpatchcmd{命令}{搜索}{替换}{成功}{失败}</code></p>
<ul>
<li><code>命令</code>：待处理的命令</li>
<li><code>搜索</code>：需要被替换的部分</li>
<li><code>替换</code>：将被替换的内容</li>
<li><code>成功</code>：替换成功执行的内容</li>
<li><code>失败</code>：替换失败执行的内容</li>
</ul>
<p>这里我们需要将 <code>\if@openright\cleardoublepage\else\clearpage\fi</code> 替换掉。用于替换的内容则是：<code>\par\relax</code>。因此我们有代码：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="command">\usepackage</span><span class="special">{</span>xpatch<span class="special">}</span>
<span class="command">\makeatletter</span>
<span class="command">\xpatchcmd</span><span class="special">{</span><span class="command">\chapter</span><span class="special">}</span>
  <span class="special">{</span><span class="command">\if</span>@openright<span class="command">\cleardoublepage</span><span class="command">\else</span><span class="command">\clearpage</span><span class="command">\fi</span><span class="special">}</span><span class="special">{</span><span class="command">\par</span><span class="command">\relax</span><span class="special">}</span>
  <span class="special">{</span><span class="special">}</span><span class="special">{</span><span class="special">}</span>
<span class="command">\makeatother</span>
</pre></td></tr></table></figure>



<p>注意，符号 <code>@</code> 是一个保留符号。它在用户编写 <code>.tex</code> 文档的时候和开发者编写宏包 / 文档类的时候具有不同含义。我们用 <code>\makeatletter</code> 将 <code>@</code> 的含义切换到开发者模式；在进行修改之后，用 <code>\makeatother</code> 将 <code>@</code> 的含义切换到用户模式。</p>
<p>这样，<code>\chapter</code> 定义中的换行部分，就被替换成了分段。</p>
<p>完整的示例代码：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>book<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>xpatch<span class="special">}</span>
<span class="command">\makeatletter</span>
<span class="command">\xpatchcmd</span><span class="special">{</span><span class="command">\chapter</span><span class="special">}</span>
  <span class="special">{</span><span class="command">\if</span>@openright<span class="command">\cleardoublepage</span><span class="command">\else</span><span class="command">\clearpage</span><span class="command">\fi</span><span class="special">}</span><span class="special">{</span><span class="command">\par</span><span class="command">\relax</span><span class="special">}</span>
  <span class="special">{</span><span class="special">}</span><span class="special">{</span><span class="special">}</span>
<span class="command">\makeatother</span>
<span class="command">\usepackage</span><span class="special">{</span>blindtext<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\blindtext</span>
<span class="command">\chapter</span><span class="special">{</span>test<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>


]]></content>
    <summary type="html"><![CDATA[<p>LaTeX 的 <code>book</code> 类中，<code>\chapter</code> 命令用来标记章节。在生成的 PDF 文稿中，<code>\chapter</code> 总是另起一页；在打开（默认）<code>openright</code> 选项的时候，可能还会空白一页。在实际使用过程中，很多人希望 <code>\chapter</code> 不要换页，紧接着当前页的内容排版。</p>
<p>传统工具没有提供此功能，因此用户需要自行修改 <code>\chapter</code> 的定义。</p>
]]></summary>
    
      <category term="Chapter" scheme="http://liam0205.me/tags/Chapter/"/>
    
      <category term="Pagebreak" scheme="http://liam0205.me/tags/Pagebreak/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[在 MacTeX 中使用中文模板]]></title>
    <link href="http://liam0205.me/2015/04/14/using-chinese-templates-in-mactex/"/>
    <id>http://liam0205.me/2015/04/14/using-chinese-templates-in-mactex/</id>
    <published>2015-04-14T09:52:30.000Z</published>
    <updated>2015-04-14T11:54:37.000Z</updated>
    <content type="html"><![CDATA[<p>中国人使用 LaTeX 的一大问题就是为文档添加中文支持。国内很多学校、期刊都有自己的模板，更多的是一些个人配置的勉强成型的小模板。Mac 用户安装 MacTeX 之后，可能会很头疼如何将这些模板移植到自己的电脑上。这篇文章对此做一个方法上的讨论。</p>
<a id="more"></a>

<p>在 LaTeX 中使用中文，<strong>不严谨地说</strong>，主要需要解决编码和字体调用的问题。</p>
<p>国内 LaTeX 圈子流行过 GBK 编码和 UTF-8 编码。前者是国标，是过去的主流，但是问题多多。现在推荐使用后者。</p>
<p>字体调用方面，原来的 <code>CCT</code>（新版）、<code>CJK</code> 还有现在的 <code>xeCJK</code>、<code>LuaTeX-ja</code> 和李阿玲的 pTeX-ng 在 TeX Live（MacTeX）底下都能正常工作。只不过，Mac 默认的字体和 Windows 默认的字体有一些不同，在这方面需要做一些调整。</p>
<p>国内期刊的模板大多数是 <code>CCT</code> 和 <code>CJK</code> 方式，其他一些模板可能比较先进，使用 <code>xeCJK</code> 方式。<code>LuaTeX-ja</code> 国内用的少，使用方法和 <code>xeCJK</code> 比较类似；pTeX-ng 尚在开发中。所以这里只介绍使用 <code>CCT</code>、<code>CJK</code> 或 <code>xeCJK</code> 三种中文支持方式在 TeX Live 里如何进行调整。</p>
<h2 id="xeCJK"><code>xeCJK</code></h2>
<p><code>xeCJK</code> 通过 <code>\setCJKmainfont</code> 等命令（<code>luatexja-fontspec</code> 则是 <code>\setmainjfont</code>）来调用操作系统内的字体，并设置为文档字体。在 Windows 底下编写的中文模板，惯常使用 Windows 自带的中易系列字体，比如</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="command">\setCJKmainfont</span><span class="special">[</span>Boldfont = SimHei, ItalicFont = KaiTi<span class="special">]</span><span class="special">{</span>SimSun<span class="special">}</span>
<span class="command">\setCJKsansfont</span><span class="special">{</span>SimHei<span class="special">}</span>
<span class="command">\setCJKmonofont</span><span class="special">{</span>FangSong<span class="special">}</span>
</pre></td></tr></table></figure>



<p>这种情况下，可以打开模板文件（<code>.tex</code>、<code>.sty</code> 或 <code>.cls</code>），找到字体设置部分，将其内容改为 Mac 的字体设置即可。比如可以参考配置：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="command">\setCJKmainfont</span><span class="special">[</span>BoldFont=STZhongsong, ItalicFont=STKaiti<span class="special">]</span><span class="special">{</span>STSong<span class="special">}</span>
<span class="command">\setCJKsansfont</span><span class="special">[</span>BoldFont=STHeiti<span class="special">]</span><span class="special">{</span>STXihei<span class="special">}</span>
<span class="command">\setCJKmonofont</span><span class="special">{</span>STFangsong<span class="special">}</span>
</pre></td></tr></table></figure>



<p>具体的含义可参考：<a href="http://liam0205.me/2014/11/02/latex-mactex-chinese-support/">为 MacTeX 配置中文支持</a></p>
<p>使用 <code>xeCJK</code> 的模板，应该都保存为 UTF-8 编码，所以不需要进行编码调整。<br>（部分模板使用 GBK 编码，在文档头会有 <code>\XeTeXinputencoding &#39;CP936&#39;</code> 的 XeTeX 原语。此时最好将文件另存为 UTF-8 编码，并删除这些原语。）</p>
<h2 id="CJK"><code>CJK</code></h2>
<p>在不适用 <code>zhmetrics</code> 技术的时候，<code>CJK</code> 需要 Type 1 字体。将中易字体拆分成许多 sub-fonts 并转换为 Type 1 字体是个费时费力的工作。CTeX 套装打包了已经配置好的 CJK 字体，它的 song、hei、kai、fs、li 和 you 等六套字体，流传甚广。国内使用 <code>CJK</code> 的模板，大都使用了这几套字体。</p>
<p>不过，<code>CJK</code> 宏包本身并不含有这些字体，所以在使用 TeX Live 的时候，直接编译这些模板会报错。</p>
<p>我们看一段最简单的使用 <code>CJK</code> 宏包做中文支持的例子。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>CJKutf8<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>CJK*<span class="special">}</span><span class="special">{</span>UTF8<span class="special">}</span><span class="special">{</span>song<span class="special">}</span>
中文。
<span class="command">\clearpage</span>
<span class="command">\end</span><span class="special">{</span>CJK*<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>对于 Windows 系统的 TeX Live 用户而言，最简单的办法是使用 <code>zhmetrics</code> 技术。为此我们只需要在导言区添加一行命令即可，代码变为：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>CJKutf8<span class="special">}</span>
<span class="command">\AtBeginDvi</span><span class="special">{</span><span class="command">\input</span><span class="special">{</span>zhwinfonts<span class="special">}</span><span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>CJK*<span class="special">}</span><span class="special">{</span>UTF8<span class="special">}</span><span class="special">{</span>song<span class="special">}</span>
中文。
<span class="command">\clearpage</span>
<span class="command">\end</span><span class="special">{</span>CJK*<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>此时，使用 pdfLaTeX 或 LaTeX - DVIPDFMx 编译文档，即可得到正确的结果。</p>
<p>对于 Mac/Linux 系统的 TeX Live（MacTeX）用户而言，简单地加载 <code>zhwinfonts.tex</code> 是不会奏效的。<code>zhwinfonts.tex</code> 是为 Windows 系统配置的文件，在 Mac/Linux 系统中缺少这些字体。我自己买了方正系列字体在 Mac 上使用，所以写了一个 <code>zhfzfonts.tex</code> 来调用这些字体。</p>
<p>需要做的事情：</p>
<ol>
<li>安装下列字体（涉及到版权，这里就不提供了）<ul>
<li>方正书宋 GBK：FZSSK.TTF</li>
<li>方正楷体 GBK：FZKTK.TTF</li>
<li>方正黑体 GBK：FZHTK.TTF</li>
<li>方正仿宋 GBK：FZFSK.TTF</li>
<li>华文隶体：STLITI.ttf（Mac 自带）</li>
<li>华文琥珀：STHUPO.TTF（Mac 自带）</li>
</ul>
</li>
<li>下载 <a href="http://liam0205.me/attachment/LaTeX-useful-tools/zhfzfonts.tex"><code>zhfzfonts.tex</code></a></li>
<li>将 <code>zhfzfonts.tex</code> 保存在 <code>TEXMFLOCAL/tex/generic/zhmetrics/</code> 目录下</li>
<li>使用 texhash 刷新文件名数据库（可能需要 root 权限）</li>
<li>调整代码</li>
</ol>
<p>这里 TEXMFLOCAL 指的是 TeX Live 供用户使用的 TDS 根目录，在 MacTeX 里是 <code>/usr/local/texlive/texmf-local</code>。</p>
<p><code>CJK</code> 支持 GBK，也支持 UTF-8。请注意将文档编码保存为与 <code>CJK</code> 环境相同的编码格式。</p>
<h2 id="CCT"><code>CCT</code></h2>
<p>以系统工程理论与实践为代表的一些国内期刊，使用 <code>CCT</code> 模板。前年为此写过一篇博客，专门讨论此类模板。参见：<a href="http://liam0205.me/2013/10/15/LaTeX-CCT-template/">国内期刊 CCT 模板编译经验</a></p>
<p><code>CCT</code> 只支持 GBK 编码。</p>
<h2 id="ctex_ 宏包 / 文档类 "><code>ctex</code> 宏包 / 文档类</h2>
<p><code>ctex</code> 宏包 / 文档类在使用 XeLaTeX 编译的时候，使用 <code>xeCJK</code> 作为中文支持方式；在使用 LaTeX/pdfLaTeX 的时候使用 <code>CJK</code> 作为中文支持方式。因此，使用 <code>ctex</code> 宏包 / 文档类的模板，在 TeX Live 系统下的配置方式需要根据所选的编译方式做调整。</p>
<p>使用 XeLaTeX 的时候，需要给 <code>ctex</code> 加上 <code>nofonts</code> 选项（将来的 2.0 版本则是 fontset = none），然后再用 <code>\setCJKmainfont</code> 配置字体。</p>
<p>使用 LaTeX/pdfLaTeX 的时候，则可以使用 <code>zhfzfonts.tex</code> 来映射字体。</p>
<p>使用 <code>ctex</code> 宏包 / 文档类的时候，需要根据所选的编译方式和宏包 / 文档类选项来确定源文件的编码格式。</p>
<ul>
<li>使用 XeLaTeX 的时候，不论选项为何，源文件都需要保存为 UTF-8 编码。</li>
<li>使用 LaTeX/pdfLaTeX 的时候，则需要根据宏包 / 文档类选项来确定源文件的编码格式。</li>
</ul>
]]></content>
    <summary type="html"><![CDATA[<p>中国人使用 LaTeX 的一大问题就是为文档添加中文支持。国内很多学校、期刊都有自己的模板，更多的是一些个人配置的勉强成型的小模板。Mac 用户安装 MacTeX 之后，可能会很头疼如何将这些模板移植到自己的电脑上。这篇文章对此做一个方法上的讨论。</p>
]]></summary>
    
      <category term="Template" scheme="http://liam0205.me/tags/Template/"/>
    
      <category term="Chinese" scheme="http://liam0205.me/tags/Chinese/"/>
    
      <category term="MacTeX" scheme="http://liam0205.me/tags/MacTeX/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[在 LaTeX 中将不编号的章节列入目录]]></title>
    <link href="http://liam0205.me/2015/04/10/how-to-list-unnumbered-section-in-the-table-of-contents/"/>
    <id>http://liam0205.me/2015/04/10/how-to-list-unnumbered-section-in-the-table-of-contents/</id>
    <published>2015-04-10T09:54:32.000Z</published>
    <updated>2015-04-10T10:41:32.000Z</updated>
    <content type="html"><![CDATA[<p>LaTeX 标准文档类提供了 <code>\section</code> 和 <code>\section*</code> 等两组命令，用于排版章节标题。其中不带星号的版本有章节编号，会列入目录，同时修改章节标记。带星号的版本只有章节标题格式而不编号，不列入目录，也不会修改章节标记。</p>
<p>有时，我们会希望将不编号的章节标题列入目录。这种情况使用 <code>\section</code> 或 <code>\section*</code> 都不大合适。本文将对这些问题做出分析，并给出解决方案。</p>
<a id="more"></a>

<p>LaTeX 标准文档类的 <code>\section</code> 命令做四件事情：</p>
<ol>
<li>编号自增 1</li>
<li>输出章节标题</li>
<li>处理目录（和 PDF 书签）</li>
<li>做页眉的章节标记</li>
</ol>
<p>相应地，<code>\section*</code> 命令只做上述第二件事情，其余三件都不做。</p>
<p>因此，我们的思路很简单，有两个方向。第一，使用 <code>\section*</code>，手工做目录的处理；第二，使用 <code>\section</code>，但是抑制编号。</p>
<h2 id=" 思路一 ">思路一</h2>
<p>LaTeX 处理目录需要编译两次。在第一次编译的过程中，<code>\section</code> 命令将目录信息写入 <code>.aux</code> 文件。随后，在第二次编译的过程中，LaTeX 读取 <code>.aux</code> 文件中的相应信息，形成目录。因此，我们只需要模仿 <code>\section</code> 写入 <code>.aux</code> 文件的过程就可以了。</p>
<p>LaTeX 提供了 <code>\addcontentsline{&lt; 辅助文件后缀 &gt;}{&lt; 章节等级 &gt;}{名字}</code> 命令来做这样的工作。我们来看一个例子。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>ctexart<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\tableofcontents</span>
<span class="command">\section*</span><span class="special">{</span>不编号的章节标题<span class="special">}</span>
<span class="command">\addcontentsline</span><span class="special">{</span>toc<span class="special">}</span><span class="special">{</span>section<span class="special">}</span><span class="special">{</span>不编号的章节标题<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<h2 id=" 思路二 ">思路二</h2>
<p>LaTeX 标准文档类中的 <code>\appendix</code> 命令，会使得后续的章节标题从 0 开始编号，同时将编号格式从阿拉伯数字修改为大写英文字母。<code>\appendix</code> 命令虽然不符合我们的需求，但是产生的效果却和我们需要的效果类似：修改了章节标题编号。我们可以对这个命令做适当的修改，达成我们的目的。</p>
<p>我们来看一下 <code>article.cls</code> 里的 <code>\appendix</code> 是如何定义的。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="command">\newcommand</span><span class="command">\appendix</span><span class="special">{</span><span class="command">\par</span>
  <span class="command">\setcounter</span><span class="special">{</span>section<span class="special">}</span><span class="special">{</span>0<span class="special">}</span><span class="comment">%</span>
  <span class="command">\setcounter</span><span class="special">{</span>subsection<span class="special">}</span><span class="special">{</span>0<span class="special">}</span><span class="comment">%</span>
  <span class="command">\gdef</span><span class="command">\thesection</span><span class="special">{</span><span class="command">\@</span>Alph<span class="command">\c</span>@section<span class="special">}</span><span class="special">}</span>
</pre></td></tr></table></figure>



<p>接下来，我们仿造它，定义一个新的命令 <code>\specialsectioning</code>。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">[</span>hyperref<span class="special">]</span><span class="special">{</span>ctexart<span class="special">}</span>
<span class="command">\newcommand</span><span class="command">\specialsectioning</span><span class="special">{</span><span class="command">\par</span>
  <span class="command">\setcounter</span><span class="special">{</span>section<span class="special">}</span><span class="special">{</span>0<span class="special">}</span><span class="comment">%</span>
  <span class="command">\setcounter</span><span class="special">{</span>subsection<span class="special">}</span><span class="special">{</span>0<span class="special">}</span><span class="comment">%</span>
  <span class="command">\renewcommand</span><span class="command">\thesection</span><span class="special">{</span><span class="command">\relax</span><span class="special">}</span><span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\tableofcontents</span>
<span class="command">\section</span><span class="special">{</span>正常编号的章节标题<span class="special">}</span>
<span class="command">\specialsectioning</span>
<span class="command">\section</span><span class="special">{</span>不编号的章节标题<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>编译之后我们会发现，在 <code>\specialsectioning</code> 之后的 <code>\section</code> 虽然不带星花，但已然不编号了，并且出现在了目录当中。</p>
<p>不过，正常标题的编号和标题正文之间是有一定的空距的。我们现在虽然将编号取消了，但是这个空距依然存在。虽然它不明显，但是毕竟是个问题。作为一个精益求精的完美主义者，我们要解决它。</p>
<p>正文中编号的格式由 LaTeX 内部宏 <code>\@seccntformat</code> 控制，默认是在编号后面加一个 <code>\quad</code>，我们把它去掉。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="command">\def</span><span class="command">\@</span>seccntformat<span class="special">#</span><span class="special">#</span>1<span class="special">{</span><span class="command">\@</span>nameuse<span class="special">{</span>the<span class="special">#</span><span class="special">#</span>1<span class="special">}</span><span class="special">}</span>
</pre></td></tr></table></figure>



<p>此外，目录中的编号和章节标题之间也有距离，我们通过 <code>tocloft</code> 宏包来将这个距离设置为 <code>0pt</code>。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="command">\addtocontents</span><span class="special">{</span>toc<span class="special">}</span><span class="special">{</span><span class="command">\def</span><span class="command">\cftsecnumwidth</span><span class="special">{</span>0pt<span class="special">}</span><span class="special">}</span>
</pre></td></tr></table></figure>



<p>这样，完整的代码变成：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>ctexart<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>tocloft<span class="special">}</span>
<span class="command">\makeatletter</span>
<span class="command">\newcommand</span><span class="command">\specialsectioning</span><span class="special">{</span><span class="command">\par</span>
  <span class="command">\setcounter</span><span class="special">{</span>section<span class="special">}</span><span class="special">{</span>0<span class="special">}</span><span class="comment">%</span>
  <span class="command">\setcounter</span><span class="special">{</span>subsection<span class="special">}</span><span class="special">{</span>0<span class="special">}</span><span class="comment">%</span>
  <span class="command">\renewcommand</span><span class="command">\thesection</span><span class="special">{</span><span class="command">\relax</span><span class="special">}</span><span class="comment">%</span>
  <span class="command">\def</span><span class="command">\@</span>seccntformat<span class="special">#</span><span class="special">#</span>1<span class="special">{</span><span class="command">\@</span>nameuse<span class="special">{</span>the<span class="special">#</span><span class="special">#</span>1<span class="special">}</span><span class="special">}</span><span class="comment">%</span>
  <span class="command">\addtocontents</span><span class="special">{</span>toc<span class="special">}</span><span class="special">{</span><span class="command">\def</span><span class="command">\cftsecnumwidth</span><span class="special">{</span>0pt<span class="special">}</span><span class="special">}</span><span class="special">}</span>
<span class="command">\makeatother</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\tableofcontents</span>
<span class="command">\section</span><span class="special">{</span>正常编号的章节标题<span class="special">}</span>
<span class="command">\specialsectioning</span>
<span class="command">\section</span><span class="special">{</span>不编号的章节标题<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<hr>
<p>问题解决了，不过思路二这样做未免麻烦。在这个思路下，会不会有更简单的方法呢？答案是肯定的。</p>
<p>在 LaTeX 标准文档类中，secnumdepth 这个计数器是用来控制章节编号深度的。在 article 中，这个计数器的值默认是 3，对应的章节命令是 \subsubsection。也就是说，默认情况下，article 将会对 \subsubsection 及其之上的所有章节标题进行编号，也就是 \part, \section, \subsection, \subsubsection。</p>
<p>LaTeX 标准文档类中，最大的标题是 \part。它在 book 和 report 类中的层级是「-1」，在 article 类中的层级是「0」。因此，我们只需要将计数器设置为 -2，之后章节命令都不会编号了，从而解决问题。</p>
<p>我们来看一下代码。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>ctexart<span class="special">}</span>
<span class="command">\makeatletter</span>
<span class="command">\newcommand</span><span class="command">\specialsectioning</span><span class="special">{</span><span class="command">\setcounter</span><span class="special">{</span>secnumdepth<span class="special">}</span><span class="special">{</span>-2<span class="special">}</span><span class="special">}</span>
<span class="command">\makeatother</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\tableofcontents</span>
<span class="command">\section</span><span class="special">{</span>正常编号的章节标题<span class="special">}</span>
<span class="command">\specialsectioning</span>
<span class="command">\section</span><span class="special">{</span>不编号的章节标题<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>怎么样？是不是简单多了？</p>
]]></content>
    <summary type="html"><![CDATA[<p>LaTeX 标准文档类提供了 <code>\section</code> 和 <code>\section*</code> 等两组命令，用于排版章节标题。其中不带星号的版本有章节编号，会列入目录，同时修改章节标记。带星号的版本只有章节标题格式而不编号，不列入目录，也不会修改章节标记。</p>
<p>有时，我们会希望将不编号的章节标题列入目录。这种情况使用 <code>\section</code> 或 <code>\section*</code> 都不大合适。本文将对这些问题做出分析，并给出解决方案。</p>
]]></summary>
    
      <category term="Section" scheme="http://liam0205.me/tags/Section/"/>
    
      <category term="Sectioning" scheme="http://liam0205.me/tags/Sectioning/"/>
    
      <category term="Numbering" scheme="http://liam0205.me/tags/Numbering/"/>
    
      <category term="Table of Contents" scheme="http://liam0205.me/tags/Table%20of%20Contents/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[将微信上的文章推送到 Kindle 上]]></title>
    <link href="http://liam0205.me/2015/03/23/push-articles-to-kindle-from-wechat/"/>
    <id>http://liam0205.me/2015/03/23/push-articles-to-kindle-from-wechat/</id>
    <published>2015-03-23T03:23:24.000Z</published>
    <updated>2015-03-23T04:57:11.000Z</updated>
    <content type="html"><![CDATA[<p>微信是近几年发展起来的社交网络。微信公众号和微信朋友圈的出现，让微信变成了一个优秀的信息发布和传播平台。有甄别能力的同好，往往能在微信上找到不少好的文章。但是，一来用手机查看文章伤眼，二来微信上的文章不变保存，三来用手机看文章需要网络支持。总之，是有诸多不便。</p>
<p>昨天思考到这个问题之后，我有做一些搜索，而后就有了欣喜的发现：可以将微信里的文章、好友发来的文字消息免费推送到 Kindle 设备上。</p>
<a id="more"></a>

<h2 id=" 原理 ">原理</h2>
<p>激活 Kindle 之后，亚马逊都会为每一台 Kindle 设备分配一个电邮地址。向这个电邮地址里发送包含电子书的邮件，就可以将电子书推送到 Kindle 上了。当然，如此的话，可能会造成垃圾信息泛滥。因为如果不加限制，任何人都能往用户的 Kindle 上推送文件，结果会是一团糟。基于这些考虑，在亚马逊官网的后台里，提供了「认可的电邮地址」的设置。亚马逊在收到邮件之后，会检查这个认可的电邮列表。只有来信电邮在列表当中，亚马逊才会将电子书推送到 Kindle 上。</p>
<p>简单来说，亚马逊将 Kindle 和一个特定的电邮地址关联在一起，通过可信邮箱往上述电邮地址发送邮件，就能把附件中的电子书推送到 Kindle 上。</p>
<p>有了这样的基础知识，就不难理解微信推送的原理了。</p>
<p>亚马逊官方在微信上设立了一个公众平台，平台的后端就是一个电子邮箱。我们将微信上的文章保存在公众平台里，后端邮箱就会把文章发送到 Kindle 邮箱中，最后再推送到 Kindle 设备上。</p>
<p><img src="/attachment/images/Kindle/wechat_flowchat.png" alt=" 推送流程图 "></p>
<p>明确原理之后，我们来进行设置。</p>
<h2 id=" 亚马逊官网 ">亚马逊官网</h2>
<p>这里以中国亚马逊为例，如果你的 Kindle 使用的是美国亚马逊账号，请登录美国亚马逊网站进行相应操作。</p>
<p>登录中亚之后，点击下面的链接，进入 Kindle 管理页面。</p>
<p><a href="https://www.amazon.cn/mn/dcw/myx.html" target="_blank">https://www.amazon.cn/mn/dcw/myx.html</a></p>
<p>进入「我的设备」一栏，找到你的 Kindle 设备对应的图标。页面下方会显示出该设备对应的 Kindle 邮箱，请记下来。</p>
<p><img src="/attachment/images/Kindle/amazon01.png" alt=" 记录 Kindle 邮箱地址 "></p>
<p>进入「设置」一栏，在页面底部，点击「添加认可的电子邮箱」，将 <code>kindle@eub-inc.com</code> 添加到列表当中。</p>
<p><img src="/attachment/images/Kindle/amazon02.png" alt=" 将 `kindle@eub-inc.com` 添加到认可的电子邮箱列表当中 "></p>
<h2 id=" 微信 ">微信</h2>
<p>首先我们要关注亚马逊的微信公众平台。搜索公众号 <code>cn_Kindle</code> 并关注「亚马逊 Kindle 服务号」。</p>
<p><img src="/attachment/images/Kindle/wechat01.jpg" alt=" 亚马逊 Kindle 服务号 "></p>
<p>接下来，进入服务号界面，向服务号发送消息 <code>绑定 + 你的 Kindle 邮箱地址</code>。比如 <code>绑定 +myemail@kindle.cn</code>。</p>
<p><img src="/attachment/images/Kindle/wechat02.jpg" alt=" 绑定 Kindle 邮箱地址 "></p>
<h2 id=" 实际使用看看 ">实际使用看看</h2>
<p>周筠老师今天分享了一篇文章，我们把它推送到 Kindle 上看看。</p>
<p>打开这篇文章后，点击右上角的 <code>···</code>，选择「亚马逊 Kindle 服务号」。</p>
<p><img src="/attachment/images/Kindle/wechat03.jpg" alt=" 一键推送到 Kindle"></p>
<p>将你的 Kindle 设备连上网络，过一会儿，就能收到推送了。</p>
<p><img src="/attachment/images/Kindle/kindle01.png" alt="Kindle 截图 "></p>
]]></content>
    <summary type="html"><![CDATA[<p>微信是近几年发展起来的社交网络。微信公众号和微信朋友圈的出现，让微信变成了一个优秀的信息发布和传播平台。有甄别能力的同好，往往能在微信上找到不少好的文章。但是，一来用手机查看文章伤眼，二来微信上的文章不变保存，三来用手机看文章需要网络支持。总之，是有诸多不便。</p>
<p>昨天思考到这个问题之后，我有做一些搜索，而后就有了欣喜的发现：可以将微信里的文章、好友发来的文字消息免费推送到 Kindle 设备上。</p>
]]></summary>
    
      <category term="WeChat" scheme="http://liam0205.me/tags/WeChat/"/>
    
      <category term="Kindle" scheme="http://liam0205.me/tags/Kindle/"/>
    
      <category term="IT" scheme="http://liam0205.me/categories/IT/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[为什么我乐于分享？]]></title>
    <link href="http://liam0205.me/2015/03/19/why-i-love-to-share/"/>
    <id>http://liam0205.me/2015/03/19/why-i-love-to-share/</id>
    <published>2015-03-19T11:39:39.000Z</published>
    <updated>2015-03-19T12:39:15.000Z</updated>
    <content type="html"><![CDATA[<p>今天在<a href="http://www.zhihu.com" target="_blank">知乎</a>上第一次尝试回答了<a href="http://www.zhihu.com/question/25520742/answer/42443974" target="_blank">一个感情类问题</a>，得到了<a href="http://www.zhihu.com/people/yeka" target="_blank">周筠老师</a>的赞同。虽说是感情类问题，但主要想提及的是关于分享和共同进步的问题。无奈这个话题相对提问来说有些偏，所以只能另开文章讨论。</p>
<a id="more"></a>

<p>媳妇儿是个文科生，偏偏和我这个理科生看对了眼。我喜欢文学，却不得要领。每次看见媳妇儿写的文章，都羡慕嫉妒并着抓耳挠腮。媳妇儿是典型的文科生，对现象和规律不如理科生那么敏感。正赶着媳妇儿要学开车，对离合器一无所知有些犯怵。走在张家界的澧水大桥上，我就给她从她接触过的几个简单的物理公式讲起，借着变速自行车的例子把离合器和变速箱的原理讲了一遍。我不知道媳妇儿有没有都听明白，但是我讲完扭头看着她，分明是一脸崇拜的花痴样（我已经做好了跪搓衣板的准备，笑）。</p>
<p>媳妇儿说，她前男友是学语言的。偏偏媳妇儿是一个上进的姑娘，那时见着男朋友懂这门语言，就想请教。然而他却怎么也不肯教，问起原因，说是「担心教会了之后就没有吸引力了」。于是媳妇儿就问我，为什么我愿意将我所知道的知识分享给她。我说，「我把这些东西教给你，帮你打开思路，那样每天就能看见一个更好的你了，而且我也有向你学习啊」。</p>
<p>其实，两个人学习的专业不同、从事的行业不同、经历的人生不同，这些不同必然造成思维方式和处事模式的差异。两个人互相从对方身上学习，互相进步，这样日子才会过得越来越好，关系也会越来越亲密。</p>
<p>后来回到住处，媳妇儿给我说「你知道嘛，爱情就是两个人互相促进共同进步，所以我和你在一起特别有安全感」。文科生就是文科生，不对，媳妇儿不愧是我媳妇儿，我对媳妇儿这句话深表赞同，而且我认为在工作上也是如此。</p>
<p>父亲在我小的时候，因为工作的关系，去过不少公司工厂。每次出差回来，父亲都会讲讲所见所闻。虽然大多数的故事我都记不得了，但是有一则故事我一直记到现在。</p>
<p>父亲说，那次去的化工厂的技术部副主任以前是个技术过硬的老师傅，靠着自己的技术一步步走到这个位置。但是，现在的主任比他年轻得多，而且是以前还在他手下干过活。其实按照老师傅的资历和技术，他早就可以得到提拔。只是老师傅当年掌握着关键技术，因为害怕被人取代，所以不真心实意地教徒弟。这样一来，很长时间里都没有人能代替老师傅的位置。因此虽然薪资加了不少，但是领导一直不怎么提拔他。他就只能看着自己曾经的手下一步步超越自己。</p>
<p>其实，一方面，总结和分享的过程对自己也是一种学习；另一方面，学习是相互的，在自己分享的过程中，也会从对方身上学到自己不具备的东西；再者，给对方机会也最终是给自己机会。所以，真正自信的人都不会害怕分享自己的知识和技能，他们的着眼点永远是共同进步，一起变得更好。</p>
<p>所以啊，在被请教的时候，以及，更多地在生活的细微末节上，都不要吝惜自己的知识不乐于分享，更不要自觉高人一等盛气凌人。我一直认为，成长不是变得势利，而是变得温柔，对全世界都温柔。乐于分享，乐于共同进步，就是一种温柔呢。</p>
]]></content>
    <summary type="html"><![CDATA[<p>今天在<a href="http://www.zhihu.com" target="_blank">知乎</a>上第一次尝试回答了<a href="http://www.zhihu.com/question/25520742/answer/42443974" target="_blank">一个感情类问题</a>，得到了<a href="http://www.zhihu.com/people/yeka" target="_blank">周筠老师</a>的赞同。虽说是感情类问题，但主要想提及的是关于分享和共同进步的问题。无奈这个话题相对提问来说有些偏，所以只能另开文章讨论。</p>
]]></summary>
    
      <category term="Share" scheme="http://liam0205.me/tags/Share/"/>
    
      <category term="Life" scheme="http://liam0205.me/categories/Life/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[微笑着离开]]></title>
    <link href="http://liam0205.me/2015/02/01/smile-to-leave/"/>
    <id>http://liam0205.me/2015/02/01/smile-to-leave/</id>
    <published>2015-02-01T04:07:45.000Z</published>
    <updated>2015-02-03T04:34:26.000Z</updated>
    <content type="html"><![CDATA[<p>于是我化作一颗树，长在你必经的路旁，在阳光下慎重地开满了花，朵朵都是我前世的期盼。<br>当你走进，请你细听，颤抖的叶是我等待的热情。<br>而当你终于无视走过，在你身后落了一地的，不是花瓣，而是我凋零的心。<br>——「一颗开花的树」·席慕蓉</p>
<a id="more"></a>

<p>这是一首席慕蓉先生的诗，我很喜欢。以前我给你读过，告诉你说，还好不是「凋零的心」。然后我将它改编，写在微博上。</p>
<p>我化作一棵树，长在你必经的路旁，在阳光下慎重地开满了花。<br>每当有人走过，花儿就挥手致意。<br>而当你走过，花儿就开始欢呼，开始雀跃；仿佛我的灵魂飞旋在上空，在盘旋，在跳舞。</p>
<p>然而如今，似乎终于到了凋零的时候。席慕蓉先生终究是先哲前辈，肆意地改编先生的诗，却最终落入先生的套。</p>
<p>二零一四年八月一日，这是我们分手的日子。今天猛然想起，掰着指头一算，居然已过半年。小时候妈妈总说，玩起来时间过得特别快，所以要特别注意管理好自己的时间。今次我第一次发现，除掉开心，原来痛苦的时候，时间也可以飞逝而过的。</p>
<p>我还记得，你刚去诺村的时候，我不在身边。我很担心，于是拜托他照顾你。我还记得，在一周年纪念的时候，他抢在第一个回复，祝我们幸福。然而如今却是你和他在一起了。</p>
<p>所以我因此而难过吗？不，并不是。那我难过吗？是的，当然有。</p>
<p>分手之后你告诉我，你在和他约会。我说我知道了。但是我没有说，我早就知道你挂掉电话，和他一起出去超市，然后在餐厅共进晚餐。<br>分手之后你告诉我，你并不是在我和他之间做选择。我说我知道了。但是我没有说，我早就知道你在他家过夜，彻夜不归。<br>其实从你们开始在一起之后的事情，我都知道，这是我一直都没有说。</p>
<p>诺村很小，其中的华人圈子更小。说是在约会而不承认「在一起了」，其实没有什么意义，只是自欺欺人对吧。</p>
<p>于是我很难过，你却质问我说「难道你不能接受，一个曾经爱过你的人，不再爱你了吗」。我说我可以。但是我没有说，我不能接受你的背叛、欺瞒以及在分手之后用这些冠冕堂皇的句子企图安慰我。</p>
<p>所以我应该恨吗？我想我可以的。异地很难，我做好了心理准备，也做到了我能做的一切，得到的却是这样的结果。我当然可以恨，谁也不能指责我。然而我却要对自己说，我不可以恨。恨你，会把过去的美好的回忆清零，也会把将来的美好抹杀。所以我不可以恨。</p>
<p>于是我开始撕裂自己。我开始在每个将醒未醒的脑海里自己扇自己的耳光，企图把你赶出这个梦境。我开始在心里用木板搭建起房子，将有你的记忆全数封印。我必须强迫自己，将我曾经珍惜的东西视作尘土，以此求得一点好过。</p>
<p>然而方向错了，注定寻不到终点。人的记忆和计算机的硬盘里的数据不一样，不是说删除就能删除的。不管如何撕裂自己，终究都还是那个我；也不管如何封闭，房子总有可以透视的洞口。强迫自己忘记，却保留着可供回忆的实体，希冀终究可以不要忘记，这本身就是一个悖论。因此我要的解药不是忘记，而是真正接受之后的坦然和若无其事。</p>
<p>于是我删掉了所有的照片，丢掉了所有的纪念。我希望不要再看见这些看到就痛苦的东西，而是在内心保留过去你带给我的美好，以及向往未来的美好。我希望不是忘记，而是坦然接受，各自祝福。就好像安怡推荐的歌中唱响的那样，离开你，却带着更完美的微笑。</p>
]]></content>
    <summary type="html"><![CDATA[<p>于是我化作一颗树，长在你必经的路旁，在阳光下慎重地开满了花，朵朵都是我前世的期盼。<br>当你走进，请你细听，颤抖的叶是我等待的热情。<br>而当你终于无视走过，在你身后落了一地的，不是花瓣，而是我凋零的心。<br>——「一颗开花的树」·席慕蓉</p>
]]></summary>
    
      <category term="Love" scheme="http://liam0205.me/tags/Love/"/>
    
      <category term="Smile" scheme="http://liam0205.me/tags/Smile/"/>
    
      <category term="Leave" scheme="http://liam0205.me/tags/Leave/"/>
    
      <category term="Life" scheme="http://liam0205.me/categories/Life/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[在 LaTeX 中进行文学编程]]></title>
    <link href="http://liam0205.me/2015/01/23/literate-programming-in-latex/"/>
    <id>http://liam0205.me/2015/01/23/literate-programming-in-latex/</id>
    <published>2015-01-23T07:48:35.000Z</published>
    <updated>2015-04-10T08:47:54.000Z</updated>
    <content type="html"><![CDATA[<p>文学编程是 TeX 的作者高德纳提出的编程方式，主张程序员在编写代码的过程中详细地记录自己的思维方式和内在逻辑。</p>
<p>这种编程方式注重编码的逻辑而将编码本身放在更次要的位置，因而不充分的设计在这种变成方式下无所遁形。文学编程的另一个优点是它产生的代码文档能帮助程序员在任意时候重新会想起当时编码的思路。</p>
<p>在 LaTeX 中，可以用 Doc 和 DocStrip 这两个工具来实现文学编程。</p>
<a id="more"></a>

<p>对于程序员来说，最重要的有三个部分：</p>
<ul>
<li>代码；</li>
<li>代码文档；</li>
<li>用户手册。</li>
</ul>
<p>使用 Doc 和 DocStrip 可以将这三个部分集中到一个 <code>.dtx</code> 文件当中。这篇文章将分三个部分讲述如何构建这样一个 <code>.dtx</code> 文件。</p>
<h2 id="-ins_ 文件 "><code>.ins</code> 文件</h2>
<p>INS 三个字母是「Install」的缩写，顾名思义，这个文件是和安装相关的。<code>.ins</code> 文件通常用来控制 TeX 从 <code>.dtx</code> 文件里释放宏包文件，它的结构最为简单，大概是这样的。</p>
<ol>
<li>作为注释的版权信息</li>
<li><strong>载入 <code>docstrip.tex</code></strong></li>
<li>写入 DocStrip 的控制命令</li>
<li>编写将写入生成文件的版权信息</li>
<li><strong>生成文件指令</strong></li>
<li>写入提示信息用以完成安装</li>
<li><strong>结束安装文件</strong></li>
</ol>
<p>这里粗体标记的是必不可少的部分，其他部分或多或少都可以省略。</p>
<p>我们逐步构建一个完整的 <code>.ins</code> 文件。</p>
<hr>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="comment">%% Copyright (C) 2003--2015</span>
<span class="comment">%% CTEX.ORG and any individual authors listed elsewhere in this file.</span>
<span class="comment">%% --------------------------------------------------------------------------</span>
<span class="comment">%%</span>
<span class="comment">%% This work may be distributed and/or modified under the</span>
<span class="comment">%% conditions of the LaTeX Project Public License, either</span>
<span class="comment">%% version 1.3c of this license or (at your option) any later</span>
<span class="comment">%% version. This version of this license is in</span>
<span class="comment">%%    http://www.latex-project.org/lppl/lppl-1-3c.txt</span>
<span class="comment">%% and the latest version of this license is in</span>
<span class="comment">%%    http://www.latex-project.org/lppl.txt</span>
<span class="comment">%% and version 1.3 or later is part of all distributions of</span>
<span class="comment">%% LaTeX version 2005/12/01 or later.</span>
<span class="comment">%%</span>
<span class="comment">%% This work has the LPPL maintenance status `maintained'.</span>
<span class="comment">%%</span>
<span class="comment">%% The Current Maintainers of this work are Leo Liu, Qing Lee and Liam Huang.</span>
<span class="comment">%% --------------------------------------------------------------------------</span>
</pre></td></tr></table></figure>



<p>这是 <code>ctex</code> 宏包的版权声明信息。</p>
<ul>
<li>这里的每一行都以百分号开头，因此在声明版权的同时不会影响正常的编译流程。</li>
<li>版权声明部分，首先是声明版权的归属。</li>
<li>接下来，声明许可协议为 LPPL。大多数 TeX 相关的宏包或软件，都在 LPPL 协议下发布。</li>
</ul>
<hr>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="command">\input</span> docstrip.tex
</pre></td></tr></table></figure>



<p>载入 <code>docstrip.tex</code>。</p>
<hr>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="command">\keepsilent</span>
</pre></td></tr></table></figure>



<p>这是 DocStrip 的控制命令之一，其作用是关闭 DocStrip 的日志输出功能。默认情况下，DocStrip 会详细输出它的每一步操作。对于大多数人来说，成百上千行的日志徒惹人嫌弃，因此我们关闭它。</p>
<p>更多的控制命令可以参考 DocStrip 的文档。</p>
<hr>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre><span class="command">\preamble</span>

    Copyright (C) 2003-2015
    CTEX.ORG and any individual authors listed in the documentation.
------------------------------------------------------------------------------

    This work may be distributed and/or modified under the
    conditions of the LaTeX Project Public License, either
    version 1.3c of this license or (at your option) any later
    version. This version of this license is in
       http://www.latex-project.org/lppl/lppl-1-3c.txt
    and the latest version of this license is in
       http://www.latex-project.org/lppl.txt
    and version 1.3 or later is part of all distributions of
    LaTeX version 2005/12/01 or later.

    This work has the LPPL maintenance status `maintained'.

    The Current Maintainers of this work are Leo Liu, Qing Lee and Liam Huang.
------------------------------------------------------------------------------

<span class="command">\endpreamble</span>
</pre></td></tr></table></figure>



<p>在 <code>\preamble</code> 和 <code>\endpreamble</code> 之间的部分，将被写入由 DocStrip 生成的所有文档（默认情况下）。比如上面这段 <code>ctex</code> 宏包的版权信息将写入每一个生成的文件。</p>
<hr>
<p>下面的内容是整个 <code>.ins</code> 文件里最重要的部分，它控制着如何生成最终的宏包文件。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span class="command">\generate</span>
  <span class="special">{</span>
    <span class="command">\usedir</span><span class="special">{</span>tex/latex/ctex<span class="special">}</span>
    <span class="command">\file</span><span class="special">{</span>ctex.sty<span class="special">}</span>                 <span class="special">{</span><span class="command">\from</span><span class="special">{</span><span class="command">\jobname</span>.dtx<span class="special">}</span><span class="special">{</span>package,style<span class="special">}</span><span class="special">}</span>
    <span class="command">\file</span><span class="special">{</span>ctexcap.sty<span class="special">}</span>              <span class="special">{</span><span class="command">\from</span><span class="special">{</span><span class="command">\jobname</span>.dtx<span class="special">}</span><span class="special">{</span>package,ctexcap<span class="special">}</span><span class="special">}</span>
    <span class="command">\file</span><span class="special">{</span>ctexsize.sty<span class="special">}</span>             <span class="special">{</span><span class="command">\from</span><span class="special">{</span><span class="command">\jobname</span>.dtx<span class="special">}</span><span class="special">{</span>package,ctexsize<span class="special">}</span><span class="special">}</span>
    <span class="command">\file</span><span class="special">{</span>ctexart.cls<span class="special">}</span>              <span class="special">{</span><span class="command">\from</span><span class="special">{</span><span class="command">\jobname</span>.dtx<span class="special">}</span><span class="special">{</span>class,article<span class="special">}</span><span class="special">}</span>
    <span class="command">\file</span><span class="special">{</span>ctexbook.cls<span class="special">}</span>             <span class="special">{</span><span class="command">\from</span><span class="special">{</span><span class="command">\jobname</span>.dtx<span class="special">}</span><span class="special">{</span>class,book<span class="special">}</span><span class="special">}</span>
    <span class="command">\file</span><span class="special">{</span>ctexrep.cls<span class="special">}</span>              <span class="special">{</span><span class="command">\from</span><span class="special">{</span><span class="command">\jobname</span>.dtx<span class="special">}</span><span class="special">{</span>class,report<span class="special">}</span><span class="special">}</span>
    <span class="command">\file</span><span class="special">{</span>ctexspa.def<span class="special">}</span>
      <span class="special">{</span>
        <span class="command">\from</span><span class="special">{</span><span class="command">\jobname</span>.dtx<span class="special">}</span>         <span class="special">{</span>ctexspa<span class="special">}</span>
        <span class="command">\from</span><span class="special">{</span>ctexpunct.spa<span class="special">}</span>        <span class="special">{</span><span class="special">}</span>
      <span class="special">}</span>
  <span class="special">}</span>
</pre></td></tr></table></figure>



<p><code>\generate</code> 命令中的<code>\file{⟨filename⟩}{\from{⟨sourcefilename⟩}{⟨optionlist⟩}}</code> 用来指定宏包文件的生成方式。这里的含义是，从 <code>⟨sourcefilename⟩</code> 中抽取含有 <code>⟨optionlist⟩</code> 标记的部分，生成 <code>⟨filename⟩</code> 这个文件。</p>
<p>一个 <code>\generate</code> 里可以有多个 <code>\file</code> 命令。一个 <code>\file</code> 命令里可以有多个 <code>\from</code> 命令。一个 <code>\from</code> 命令里的 <code>⟨option⟩</code>，组成 <code>⟨optionlist⟩</code>。其中 <code>⟨option⟩</code> 需要用逗号隔开，<code>\file</code> 之间和 <code>\from</code> 之间则不需要。</p>
<hr>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre><span class="command">\obeyspaces</span>
<span class="command">\Msg</span><span class="special">{</span>*************************************************************<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*                                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>* To finish the installation you have to move the following *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>* file into proper directories searched by TeX:             *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*                                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>* The recommended directory is TDS:tex/latex/ctex           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*                                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*     ctex.sty                                              *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*     ctexcap.sty                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*     ctexsize.sty                                          *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*     ctexart.cls                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*     ctexbook.cls                                          *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*     ctexrep.cls                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*     ctexspa.def                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*                                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>* To produce the documentation run the file ctex.dtx        *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>* through XeLaTeX.                                          *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*                                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>* Happy TeXing!                                             *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*                                                           *<span class="special">}</span>
<span class="command">\Msg</span><span class="special">{</span>*************************************************************<span class="special">}</span>
</pre></td></tr></table></figure>



<p>这里的内容会在处理完 <code>.ins</code> 文件之后显示在控制台，用来提示使用者将文件置入指定的目录。TeX 会忽略连续的空格，第一行的 <code>\obeyspaces</code> 则会让 TeX 输出这些空格。</p>
<hr>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="command">\endbatchfile</span>
</pre></td></tr></table></figure>



<p>显式地结束安装文件，此后的所有内容都会被忽略。</p>
<p>将上面的代码依次粘贴到一起，就是一个最简单的 <code>.ins</code> 文件了。</p>
<h2 id="-dtx_ 文件 "><code>.dtx</code> 文件</h2>
<p><code>.dtx</code> 文件比 <code>.ins</code> 文件复杂得多。<code>.ins</code> 文件在整个过程中会被读取一次，而 <code>.dtx</code> 文件却会被读取三次。下面是对此三个步骤的简略描述。如果暂时看不懂也没有关系，下一节我们将会化身人肉编译器，逐行分析示例。</p>
<p>处理 <code>.ins</code> 文件的时候，会载入 <code>.dtx</code> 文件。这时候 <code>.dtx</code> 文件中以 <code>%</code> 开头的行将被全部忽略，而以 <code>%</code> 开头的行则会用于记录 <code>⟨option⟩</code>。程序会根据 <code>.ins</code> 文件中 <code>\generate</code> 命令里 <code>\from</code> 的指示的 <code>⟨option⟩</code> 抽取 <code>.dtx</code> 文件中 <code>⟨option⟩</code> 相关内容。这个过程中，没有以 <code>%</code> 开头的行会根据 <code>⟨option⟩</code> 写入文件，而 <code>%</code> 开头的行则被抑制并保护起来。最终生成宏包文件。</p>
<p>第二遍处理 <code>.dtx</code> 文件的时候，在读入 <code>\documentclass{ltxdoc}</code> 之前，所有的内容与通常意义上的 LaTeX 代码完全一致。因此需要依靠 <code>\iffalse</code> 和 <code>% \iffalse</code> 来保护相关代码，这些代码通常是 README 文件和 LICENSE 文件。在读入 <code>\DocInput{filename.dtx}</code> 之后，<code>.dtx</code> 文件会被第三次载入处理。处理完成之后遇到 <code>\end{document}</code>，后续的内容被全部忽略。最终生成说明文档。</p>
<p>第三遍处理 <code>.dtx</code> 是被 <code>\DocInput</code> 载入的。此时，文档内（几乎）所有的 <code>%</code> 都被忽略。因为 LaTeX 只能有一个 <code>\documentclass</code> 以及一对 <code>\begin{document}</code> 和 <code>\end{document}</code>，所以 <code>\end{document}</code> 之前的所有内容都应当在这一次处理的时候被忽略。因此这部分内容应该被 <code>\iffalse</code> 和 <code>\fi</code> 保护起来。</p>
<p><code>.dtx</code> 文件由以下部分组成。</p>
<ol>
<li>包含在 <code>% \iffalse</code> 和 <code>% \fi</code> 中间的版权信息</li>
<li><strong>包含在 <code>% \iffalse</code> 和 <code>% \fi</code> 中间的宏包基本信息</strong></li>
<li><strong>包含在 <code>%&lt;*driver&gt;</code> 和 <code>%&lt;/driver&gt;</code> 中间的 <code>ltxdoc</code> 文档类及相关代码，这部分代码也应包含在 <code>% \iffalse</code> 和 <code>% \fi</code> 中间</strong></li>
<li><strong>在 <code>\end{document}</code> 之后的说明文档，这部分文档应该隐藏在行首的 <code>%</code> 之后</strong></li>
<li><strong>在说明文档最后的代码说明，以及间杂在代码说明中间的代码，其中代码说明也应该隐藏在行首的 <code>%</code> 之后，而代码本身则不应该被 <code>%</code> 保护</strong></li>
</ol>
<p>示例 <code>.dtx</code> 文件的具体内容，可以参看下一节。</p>
<h2 id=" 人肉编译器 ">人肉编译器</h2>
<p>我们来看两个文件，分别是 <a href="/attachment/LaTeX-useful-tools/dtxtut/dtxtut.ins"><code>dtxtut.ins</code></a> 和 <a href="/attachment/LaTeX-useful-tools/dtxtut/dtxtut.dtx"><code>dtxtut.dtx</code></a>。你可以下载这两个文件，然后跟着我的思路一起分析。</p>
<p>首先我们要生成宏包文件，在命令行中运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>xelatex dtxtut.ins
</pre></td></tr></table></figure>



<p>注意，这里的后缀名不可省略。</p>
<p>文件读入之后，直到 12 行都是注释，直接忽略。接着到了第 13 行，读入了 <code>docstrip.tex</code> 这个文件。随后进行了一些设置之后来到了第 26 行.</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="command">\generate</span><span class="special">{</span><span class="command">\file</span><span class="special">{</span><span class="command">\jobname</span>.sty<span class="special">}</span><span class="special">{</span><span class="command">\from</span><span class="special">{</span><span class="command">\jobname</span>.dtx<span class="special">}</span><span class="special">{</span>package<span class="special">}</span><span class="special">}</span><span class="special">}</span>
</pre></td></tr></table></figure>



<p>这里 <code>\jobname</code> 是当前文件的名字（不含后缀），即 <code>dtxtut</code>。所以这里会从 <code>dtxtut.dtx</code> 文件中，抽取 <code>package</code> 的部分，组成名为 <code>dtxtut.sty</code> 这个文件。</p>
<p>现在我们读取 <code>dtxtut.dtx</code>。前 18 行都是注释，忽略。19 — 21 行是 <code>package</code> 部分，输出。23 行开始了名为 <code>driver</code> 的部分，直到 32 行结束。接下来一直到 81 行都是注释，忽略。82 行开始了名为 <code>package</code> 的部分，于是程序将 82 行开始到 100 行中没有注释掉的部分抽出来，输出。这样，输出的内容接在 <code>\preamble</code> 之后，保存为 <code>dtxtut.sty</code> 文件。</p>
<p>接下来我们生成宏包文档，在命令行中运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>xelatex dtxtut.dtx
</pre></td></tr></table></figure>



<p>同样，这里的后缀名不可省略。</p>
<p>前 23 行都是注释，忽略。24 行载入了 <code>ltxdoc</code> 文档类，随后载入了刚刚生成的 <code>dtxtut.sty</code> 宏包。26 行的 <code>\EnableCrossrefs</code> 打开了代码索引的生成（如果你将来不需要，可以用 <code>\DisableCrossrefs</code> 打开）。27 行的 <code>\CodelineIndex</code> 则使得索引指向代码行号，而不是页码。28 行的 <code>\RecordChanges</code> 则会让文档类记录宏包的变化记录。</p>
<p>接下来，30 行的 <code>\DocInput{\jobname.dtx}</code> 重新载入了这个文件本身，但（几乎）所有的 <code>%</code> 符号都被忽略。第 1 行遇到 <code>\iffalse</code>，直到 16 行的 <code>\fi</code>，中间的内容都被忽略。17 行是空行。18 行又遇到 <code>\iffalse</code>，直到 33 行的 <code>\fi</code>，中间的内容都被忽略。注意，这里正好跳过了 <code>driver</code> 部分。</p>
<p>接下来的 <code>\CheckSum</code> 和 <code>\CharacterTable</code> 是为了检测 <code>.dtx</code> 文件完整性的两个工具。众所周知，<code>.dtx</code> 文件包含了一个宏包的几乎所有信息，如果文件在网络传输的过程中出错，则宏包安装必然失败。因此，检测文件的完整性就变得很有必要。</p>
<p><code>\CheckSum</code> 采用了一个很简单的方案来检验完整性。它将从 <code>\StopEventually</code> 开始到 <code>\Finale</code> 结尾的，在 <code>macrocode</code> 环境里的反斜杠 <code>\</code> 计数，将计数的值作为校验和。在生成文档的过程中，程序将会计算这个值，并于 <code>\CheckSum{}</code> 中的值进行比对。若二者不一致，则说明传输过程中可能出现错误。</p>
<p><code>\CharacterTable</code> 更为直接一点。程序将检查代码中出现的符号均包含在 <code>\CharacterTable</code> 之中。若不然，则认为传输过程中可能出错。</p>
<p>接下来的内容，直到第 76 行都很好理解。77 行出现了 <code>\StopEventually</code> 命令，并在参数中启动了 <code>\PrintIndex</code> 命令。我们刚才说了 <code>\StopEventually</code> 会开启校验和的检查，而 <code>\PrintIndex</code> 则会在此处打印代码索引。</p>
<p><code>macrocode</code> 环境是一个特殊的环境，它有点类似于 LaTeX 原生的 <code>verbatim</code> 环境。它在大多数情况下的行为和 <code>verbatim</code> 环境相同，大体上是将代码输出到最终的文档当中。</p>
<p>这样持续运行到 103 行，遇到 <code>\Finale</code> 命令，校验和计算的终点。此时，程序将会计算出校验和，并与文档中给出的校验和进行比较。如果 <code>\CheckSum</code> 不存在，或者给出的值为 <code>0</code>，那么程序会给出正确的值，让你填入文档。如果 <code>\CheckSum</code> 存在，但值与程序计算的不符，那么程序会报错，并给出正确的值。改正后重新编译才能得到文档。如果 <code>\CheckSum</code> 存在，且校验和通过，那么程序会继续运行。</p>
<p>104 行是 <code>\endinput</code>，结束整个文件，本次对 <code>dtxtut.dtx</code> 的处理结束，回到上一次的断点。</p>
<p>30 行之后，31 行就是 <code>\end{document}</code>，文档处理结束，之后的内容全都被忽略。输出文档，退出。</p>
<h2 id=" 将 _-dtx_ 和 _-ins_ 合二为一 ">将 <code>.dtx</code> 和 <code>.ins</code> 合二为一</h2>
<p>细心的读者会发现，整个过程中，<code>.dtx</code> 文件承担了几乎所有的功能，而 <code>.ins</code> 文件只是一个「指路人」。这些读者可能会思考，是不是有办法将 <code>.ins</code> 文件并入 <code>.dtx</code> 文件呢？答案是肯定的。</p>
<p>对于这类合二为一的 <code>.dtx</code> 文件，使用 Plain TeX 格式编译，会启动 DocStrip 工具，得到宏包文件；使用 LaTeX 格式编译，则会生成文档。</p>
<p>这里给出一个来自<a href="http://www.zhihu.com/question/27693438" target="_blank">知乎提问</a>的<a href="/attachment/LaTeX-useful-tools/dtxtut/insdtxtut.dtx">示例</a>（略有修改），你可以在<a href="http://www.zhihu.com/question/27693438/answer/37669407" target="_blank">我的答案</a>里看到对此的具体分析。</p>
<h2 id=" 最后的最后 ">最后的最后</h2>
<p>今天是 W 的生日。祝你生日快乐~</p>
]]></content>
    <summary type="html"><![CDATA[<p>文学编程是 TeX 的作者高德纳提出的编程方式，主张程序员在编写代码的过程中详细地记录自己的思维方式和内在逻辑。</p>
<p>这种编程方式注重编码的逻辑而将编码本身放在更次要的位置，因而不充分的设计在这种变成方式下无所遁形。文学编程的另一个优点是它产生的代码文档能帮助程序员在任意时候重新会想起当时编码的思路。</p>
<p>在 LaTeX 中，可以用 Doc 和 DocStrip 这两个工具来实现文学编程。</p>
]]></summary>
    
      <category term="Literate Programming" scheme="http://liam0205.me/tags/Literate%20Programming/"/>
    
      <category term="dtx" scheme="http://liam0205.me/tags/dtx/"/>
    
      <category term="Macro" scheme="http://liam0205.me/tags/Macro/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[欧洲史·三：浪漫主义与古希腊哲学]]></title>
    <link href="http://liam0205.me/2015/01/22/history-of-europ-03/"/>
    <id>http://liam0205.me/2015/01/22/history-of-europ-03/</id>
    <published>2015-01-22T08:09:38.000Z</published>
    <updated>2015-01-22T16:13:57.000Z</updated>
    <content type="html"><![CDATA[<p>前两篇文章（<a href="/2014/12/30/history-of-europe-01/">第一篇</a>、<a href="/2015/01/06/history-of-europe-02/">第二篇</a>）讨论了欧洲文明发源的三股力量，以及欧洲思想发源的几次思想运动。今次，我们将暂别对理性的讨论，转而讨论与理性相对的浪漫主义；同时我们也会一睹古希腊三大哲人的风采。</p>
<a id="more"></a>

<h2 id=" 浪漫主义 ">浪漫主义</h2>
<h3 id=" 浪漫主义运动从德国发端 ">浪漫主义运动从德国发端</h3>
<p>我们前面说到，欧洲这个混合体由希腊罗马、教会和日耳曼民族组成。前面说到的浪漫主义运动、宗教改革、科学革命还有启蒙运动主要都是前两个部分相互作用的结果。今次要谈的浪漫主义运动则发短语继承自日耳曼民族的德意志民族。（公元 919 年之后建国的国家中的人民称德意志，之前称日耳曼）</p>
<p>18 世纪末，法国爆发了大革命，传统的君主制阶层观念、贵族以及天主教会统治制度在三年内被推翻；新的自由、平等、博爱等原则被建立起来。尽管人们对理性的期望很高，但是法国大革命废除了君主和教会之后，并没有迎来民智开启的时代，反而因为激进的思想，迎来了流血、暴政和独裁。</p>
<p>针对法国启蒙运动的观点，发端于德意志的浪漫主义运动崇尚感受、情绪和强烈的情感。德国人认为理性但抽象的词语不能用来描绘人类和社会，这完全是空谈；他们相信自己的历史和文化根治于自己体内，因此与法国人是不同的，所以法国人在沙龙里谈论的普世理性是不存在的；他们希望知道早期日耳曼民族在进入结合体之前是什么状态，喜欢他们的活力和补拙。</p>
<p>浪漫主义认为<strong>文明是人为的，因此文明会束缚和局限我们。因此，超脱这些束缚，活在传统文化当中，才算是活得完整。</strong>至此，知识分子才开始尊重并对文化开始有兴趣，开始收集民俗文化和乡村歌谣。并且从此，这些观念深植于欧洲人的思想之中。</p>
<h3 id=" 民主主义源自浪漫主义 ">民主主义源自浪漫主义</h3>
<p>浪漫主义对自己民族历史和文化的尊重被扩大强化之后，就形成了民族主义。民族主义者认为拥有相同历史、文化和语言的人们组成的民族应当生活在一起，并组建自己的政府。民族主义者认为，多民族的国家里，任何一个民族都无法充分表达自己的观点，无法充分伸张自己的文化，因此任何民族的智慧都无法开花结果。</p>
<h3 id=" 教会的结局 ">教会的结局</h3>
<p>中世纪结束之后，文艺复兴、宗教改革、科学革命、启蒙运动以及浪漫主义运动分别在不同的角度削弱了教会的权威。事实上，现代理性、科学和进步的思想从文艺复兴、科学革命和启蒙运动一脉相承自古希腊；而现在对文化、解放思想的崇尚则从浪漫主义运动继承自日耳曼民族。反观教会，留下的则是一片空白。</p>
<h2 id=" 理性和浪漫的撕扯 ">理性和浪漫的撕扯</h2>
<p>理性和浪漫是两股根植在欧洲人心中的截然相反的力量。这两股力量往往对立，互相撕扯。</p>
<p>我们先来看一个例子。如果在学校里给学生讲述下面这段故事，并将之奉为真理，你会怎么看待？这个故事来自旧约圣经的第一篇：创世纪。</p>
<blockquote>
<p>耶和华上帝用地上的尘土造人，将生气吹在他鼻孔里，他就成了有灵的活人，名叫亚当。</p>
</blockquote>
<p>如果你的孩子是这个学校里的一个学生，你会怎么想呢？作为一个现代社会的文明人，你一定会反对学校这样的做法，你会认为学校在胡说八道误人子弟。</p>
<p>那么反过来，再看另外一个故事。这个故事是澳大利亚土著人的一个传说。</p>
<blockquote>
<p>很久很久以前，有个老人非常疼爱他的侄儿。年轻的侄儿远赴异国，爱上了一个年轻女孩儿。这对情侣后来不顾长辈的反对，私奔出走。但女孩儿已被许配给另外一个人，所以女孩儿的部落派人追到他们，杀死了他的侄儿。老人听到噩耗非常伤心，不顾年老体弱，跋涉到这个国家，打算将侄儿的尸体带回故土。</p>
<p>侄儿已经成年，然而老人年事已高。将侄儿的尸体从异国运回故土，对于老人来说是个沉重的负担。但是老人办到了，它将尸体带回，妥善安葬。至今你仍然能够看到老人跋涉的足迹，仍然能看到他中途休息的地方，仍然能看到他的泪水汇成的水潭。</p>
</blockquote>
<p>同样的假设，你会怎么想呢？尽管你知道这个故事浪漫主义色彩浓厚，肯定不是真实的，但是你可能仍然会希望学校将这个「美好」的故事讲给学生们听。</p>
<p>两个故事都有明显不真实的地方，但是我们对它们的态度却截然不同。面对第一个故事的时候，理性占了上风；而面对第二个故事的时候，浪漫主义的情怀却占了上风。</p>
<p>若然生活在启蒙时代，可能会有人对你说：「如果你的孩子想知道水潭的来源，那你可以送他去学地质学」。可能还有人会对你说：「这些土著人的思想已经被黑暗和魔法带来的恐惧束缚住了，你不要相信这些」。这感觉很别扭不是吗？对于我们来说，我们往往会迷失在浪漫主义的情怀之中，潜意识地认为土著人的生活方式更加纯粹、健全和自然，不由自主地希望这些「信仰」传承下去。</p>
<p>这样的撕扯就是理性和浪漫对立的一面。这样的撕扯源自于启蒙运动和浪漫主义运动的冲突，而追根究底的原因是欧洲文明那个奇怪的混合体的矛盾。这样的撕扯不断困扰和瓦解着欧洲的道德观念和智识生活，并成为欧洲人的「宿命」之一。</p>
<h2 id=" 古希腊三大哲人的风采 ">古希腊三大哲人的风采</h2>
<p>让我们「重归」理性。</p>
<p>前文已经提到，文艺复兴时期的人们认为「古典就是最好的」。这样的观点在 17 世纪才因古希腊人的宇宙观（地心说）被打破而逐渐缓解。自那时起，人们慢慢将目光从古希腊已有的成就上转移开来，开始关注现代人可能达成的成就。</p>
<p>不过，尽管如此，在一些领域里我们的成就依然坐落在希腊人打下的基石上。而对后世影响甚深的人就是古希腊的三大哲人：苏格拉底、柏拉图和亚里士多德。</p>
<h3 id=" 苏格拉底 ">苏格拉底</h3>
<p>苏格拉底是一个，呃……，对思辨的向往近乎疯魔的人。他作为古希腊最伟大的哲人之一，并没有给出真理，但是去做了更伟大的事：给出了迈向真理的方法。</p>
<p>苏格拉底认为真理切实存在，但平常人的心智并不足以理解真理。因此，渴望得到真理的人必须耕耘其心智。而这种方法其实就是「有理有据地怀疑一切」。</p>
<p>苏格拉底问答法是类似于这样的对话：</p>
<blockquote>
<p>老师：什么是革命？</p>
<p>学生：用武力推翻政府就是革命。</p>
<p>老师：如果国王的弟弟弑君篡位，那么这样以武力推翻的行为是革命吗？</p>
<p>学生：不是。</p>
<p>老师：那除了武力推翻之外，还需要怎样的条件才能算是革命呢？</p>
</blockquote>
<p>苏格拉底问答法实际是在不断地举出反例的过程中，修正已有的观点。这样的方法能不断剔除谬误的部分，使得结论逐渐趋向真理。</p>
<h3 id=" 柏拉图 ">柏拉图</h3>
<p>柏拉图是苏格拉底的弟子。如今有关苏格拉底的实际，一部分就是出自柏拉图之手。苏格拉底「怀疑一切」的主张影响了雅典的统治者，因此被最终处死。在柏拉图的描述中，苏格拉底平静地面对死亡，对无法思辨的苟且无法容忍，从容地结束了自己的生命。</p>
<p>然而，如若换过一个角度，人们对苏格拉底的崇敬可能就会大打折扣。比如，如果公诉苏格拉底的检察官之子因为听信苏格拉底的言论，怀疑一切，最终成为一个不务正业的酒鬼；然后检察官认为苏格拉底是妖言惑众，应当处死。</p>
<p>这样的思辨，其实正是苏格拉底崇尚的「怀疑一切」。而对一切事物都充满怀疑，会让我们迷失方向；我们不可能靠纯粹的理性生活、工作并组成社会，我们在理性的同时，也需要有风俗、习惯甚至是宗教来指引方向。</p>
<p>柏拉图认为，<strong>我们在世间的所思所想，其实只是另一个崇高世界里的影子</strong>。因此，单纯地依靠思辨，单纯地怀疑一切，并不能求得真理。柏拉图为了说明他的观点，举了一个例子。</p>
<blockquote>
<p>假设有一群人，被关在暗无天日的深邃山洞。山洞只有一个洞口，被铁门锁死。洞口的外面是长长的走廊，走廊的尽头有一只火把。</p>
<p>火把摇曳的火光将经过的人和动物投影在山洞里的墙壁上，于是这些人在山洞里为看到的影子评头论足，进行推理辩论，相信这就是这个世界上真实的存在。</p>
</blockquote>
<p>这其实就是中国「坐进观天」故事的翻版，很可笑不是吗？<strong>当你身锁牢笼却不自知，目光局限在其中，光靠思辨是不可能获得真理的</strong>。</p>
<h3 id=" 亚里士多德 ">亚里士多德</h3>
<p>亚里士多德是柏拉图的学生，没错他是苏格拉底的徒孙。亚里士多德在许多方面都有重大贡献，他总结整理了很多已有的知识，并根据自己的观察得出了很多精彩的结论。诚然，受于条件所限（身处某个牢笼），他的结论在如今看来并不完全正确（比如地心说）；但是，亚里士多德对与清晰思考的理论却依然闪耀。这就是「亚里士多德三段论」。</p>
<p>亚里士多德的三段论将论述分为三个部分，前两个部分是前提，第三个部分是结论。第一个部分是抽象的概述；第二个部分是对具体实例的描述；第三个部分则针对实例做出推论。<strong>如果前提正确，并且推论过程符合逻辑，那么结论就必然是正确的</strong>。</p>
<p>比如：</p>
<blockquote>
<p>每一只正常的猫都有四条腿。</p>
<p>Kitty 是一只正常的猫。</p>
<p>Kitty 有四条腿。</p>
</blockquote>
<p>这就是一个成立的结论。首先，前两个前提是正确的；其次，两个前提之间有「连续的主宾判断逻辑」；因此，结论成立。</p>
<p>再比如：</p>
<blockquote>
<p>每一只正常的猫都有四条腿。</p>
<p>Kitty 有四条腿。</p>
<p>Kitty 是一只正常的猫。</p>
</blockquote>
<p>这是一个不成立的结论。尽管两个前提是正确的，但是两个前提之间并没有连续的逻辑，因此结论是站不住脚的。比如，Kitty 可能是一只兔子，或是一只狗。</p>
<p>再比如：</p>
<blockquote>
<p>每一只猫都是黑色的。</p>
<p>Kitty 是一只猫。</p>
<p>Kitty 是黑色的。</p>
</blockquote>
<p>这也是一个不成立的结论。尽管两个前提之间有连续的逻辑，但是第一个前提是错误的，因此结论也是站不住脚的。</p>
<p>尽管举出的例子很简单，但是却反映了亚里士多德三段论的威力。三段论的意义在于</p>
<ul>
<li>它给出了推理的一般规则：严谨遵循这个规则就能求得真理；</li>
<li>它给出了检验推论的标准：从前提的正确性和推理的逻辑性两方面检查推论，若然有一方面错误，则结论不成立。</li>
</ul>
<h2 id=" 小结 ">小结</h2>
<p>欧洲的文明发端于古代希腊和罗马与教会和日耳曼民族混合成为的一个不稳定的混合体。这个混合体随着文艺复兴运动而逐渐瓦解，经历宗教改革、科学革命、启蒙运动和浪漫主义运动，宗教的力量被削弱，逐渐形成我们如今看到的欧洲。</p>
<p>理性和浪漫的力量彼此对立，互相撕扯。这份根植在欧洲人文化血脉里的矛盾，煎熬着欧洲人的同时，也成为欧洲不断进步的动力。</p>
<p>尽管在科学革命之后，人们已不再将古希腊的学术奉为圭臬，但实际上是人们重新走在了由希腊人奠基的理性思辨道路上。苏格拉底为人们展现了通往真理的道路；他的弟子柏拉图用经典的比喻警醒人们不能坐进观天；柏拉图的弟子亚里士多德则在前辈的基础上整理了很多知识，并总结出了威力强大的「三段论」。</p>
<p>真想去欧洲看看呀~ : )</p>
]]></content>
    <summary type="html"><![CDATA[<p>前两篇文章（<a href="/2014/12/30/history-of-europe-01/">第一篇</a>、<a href="/2015/01/06/history-of-europe-02/">第二篇</a>）讨论了欧洲文明发源的三股力量，以及欧洲思想发源的几次思想运动。今次，我们将暂别对理性的讨论，转而讨论与理性相对的浪漫主义；同时我们也会一睹古希腊三大哲人的风采。</p>
]]></summary>
    
      <category term="History" scheme="http://liam0205.me/tags/History/"/>
    
      <category term="Europe" scheme="http://liam0205.me/tags/Europe/"/>
    
      <category term="Romantic" scheme="http://liam0205.me/tags/Romantic/"/>
    
      <category term="Greece" scheme="http://liam0205.me/tags/Greece/"/>
    
      <category term="Philosophy" scheme="http://liam0205.me/tags/Philosophy/"/>
    
      <category term="Literature and Social Sciences" scheme="http://liam0205.me/categories/Literature%20and%20Social%20Sciences/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[欧洲史·二：欧洲的思潮]]></title>
    <link href="http://liam0205.me/2015/01/06/history-of-europe-02/"/>
    <id>http://liam0205.me/2015/01/06/history-of-europe-02/</id>
    <published>2015-01-06T13:27:37.000Z</published>
    <updated>2015-01-22T08:20:23.000Z</updated>
    <content type="html"><![CDATA[<p><a href="/2014/12/30/history-of-europe-01/">上一次</a>讲到欧洲文明发端的三股力量和古典、中世纪和近代在事件和时间上的划分。今次写一写和思想有关的东西。</p>
<p>上述三股力量组成的混合体经历了长达一千年的中世纪时期。然而，尽管持续时间很长，这个混合体内部却并不稳定。伴随着文艺复兴的开始，从公元 1400 年左右开始，这个混合体逐渐崩毁，并开始建立起新的秩序。</p>
<a id="more"></a>


<h2 id=" 文艺复兴 ">文艺复兴</h2>
<p>前一篇文章里提到，中世纪时期，基督教会保留了许许多多的古希腊科学文化知识。然而，基督教会却没有将这些科学文化知识公开；而是藏起来，选择其中对维护自己教义有利的知识，甚至是曲解其中的含义来维护自己的教义。这实际上是对人的思想的一种控制。基督教会利用这些知识，将人们日常生活中能够观察到的现象和基督教的神学联系起来，控制人们的思想，巩固自己的地位。</p>
<p>文艺复兴运动的意义在于，当时有许多游离于教会之外的学者，将这些知识从神学当中剥离开来。它将人们的生活从神圣的教会的光辉中解脱出来，认为宗教只是私人事情的一部分，不应该左右社会，也不应该控制人们的思想。总而言之，它将社会逐渐世俗化。</p>
<p>将知识从教会的手中解放出来本来应当是一件好事。可是，当时的学者认可古希腊的科技知识，向往其时的社会状态，并对此达到了一种狂热的地步。<strong>他们认为古希腊的科技文化知识是经典的、最好的、无与伦比无法超越的。也就是说，他们继承了古希腊的知识，却未能继承古希腊人们辩证的思想。</strong></p>
<p>在文艺复兴运动中，思想得以从教会的控制中解放，然而将古希腊当做是「上限」却又阻碍了欧洲「再进一步」。</p>
<p>事实上，「古典」、「中世纪」和「近代」这样的划分就是文艺复兴时期的观点。那时候人们认为古典世界已然臻至完美，却在中世纪被基督教会掌控逐渐偏离正道，而文艺复兴又重新回到了正轨。古希腊人曾经认为人体是完美的，在艺术上的裸体展现得是人体的力量和美。而中世纪的绘画雕塑则对裸体遮遮掩掩，反映的是基督教的原罪，认为裸体是邪恶的。到了文艺复兴，米开朗琪罗的雕塑作品，当然是裸体塑像，则被认为是尊贵、高尚和美丽的化身。</p>
<p>而反过来，欧洲人至今以基督诞生的那年作为纪年起点。前一种对年代的划分明显排斥基督教，实际的纪元却又与基督教密不可分。</p>
<p>此间的矛盾一方面反映了欧洲继承自「混合体」，另一方面反映出文艺复兴虽然是思想的一次革命，但却不够彻底。</p>
<h2 id=" 宗教改革 ">宗教改革</h2>
<p>前文提到，在进入罗马帝国的几百年间，基督教发展出了庞大而完善的体制；在罗马帝国灭亡之后，教皇与君主平起平坐，管理文武百官。最终的结果就是前文提到的「基督教变成了罗马人的宗教」。</p>
<p>实际上，教会发展到最后，变成了这样一种怪物：教义由教会制定、整个社会也受教会管理、对犯错的人的审判也由教会进行。你没看错，立法权、行政权、司法权都被教会一手掌握。这种畸形的怪物发展到什么地步呢？如果你是一个富商，在你将死的时候，会有神父告诉你，你必须把钱捐出来给教会，不然你就进不了天堂。</p>
<p>马丁·路德是一名虔诚的基督教徒，他对自己的原罪感到无可奈何，对如何救赎毫无头绪，终日煎熬。他不知道自己一个浑身罪恶的人，如何才能得到救赎。有一天，马丁·路德读到《圣经》中保罗写给罗马教会的书信，信中说：「只要你相信耶稣基督，就能得到救赎」。也就是说，你其实什么也不用做，不用遵循教会制定的法度，不用对神父言听计从，只要相信上帝，坚守自己的信仰，就能得到救赎。</p>
<p>马丁·路德认为，《圣经》是唯一的权威：凡是圣经上没有写的，教会就没有理由去制定或者执行哪个「训令」。马丁·路德意识到，人们的思想为教会所控制，根本原因在于《圣经》是由拉丁文所写，并不是人人都能阅读的。于是马丁·路德将《圣经》翻译成德文，使得人人都能从《圣经》中得到自我救赎的力量。</p>
<p>马丁·路德的基督教后来从罗马教会的基督教中分离出来。遵循「因信称义」的观点的马丁·路德教派，后来发展为「基督新教」，而罗马教会的基督教，则被称为「天主教」。</p>
<p>宗教改革的核心观点在于，<strong>《圣经》是唯一的权威，基督教并不是罗马人的，要让基督教回到中世纪之前的样子</strong>。</p>
<p>有意思的是，马丁·路德从天主教那里拿来《圣经》把它翻译出来，变得人人都可以读，人人都可以从中得到自己的见解。于是，原本唯一的、权威的解读不复存在了，各种解读并立而起，马丁·路德自己的解释也被攻击。经过百余年的争吵，谁也无法说服谁，天主教和基督新教慢慢变得和平共处。</p>
<p>文艺复兴和宗教改革在一定意义上都是「回到过去」。文艺复兴从罗马教会那里拿来古希腊和古罗马的文化知识，来对抗教会对知识的钳制；宗教改革则从罗马教会那里拿来圣经，颠覆天主教的神学和权威。接下来 17 世纪的科学革命则整个颠覆了过去人们的观念。</p>
<h2 id=" 科学革命 ">科学革命</h2>
<p>由于观测手段的限制，希腊人认为地球是宇宙的中心——有谁能推动地球呢？17 世纪，这个观点终于被推翻。地球环绕着太阳运行，太阳才是这个天体系统的中心。</p>
<p>首先是观测。随着观测手段的不断进步，人们对星体运行的轨迹描绘得越来越精确。与此同时，这些轨迹与地心说的轨迹误差越来越大，地心说的维护者不得不去不断进行修正，使得地心说的模型变得越来越复杂。其次时理论。牛顿的万有引力定律和相应的数学手段为日心说提供了有力的理论武器。人们精确地计算出了地球绕太阳运转的轨道，与观测事实符合得很好。</p>
<p>这样一来，地心说终于招架不住，教会不得不低头，承认日心说。在科学发展的过程中，人们产生了两种情绪：</p>
<ul>
<li><strong>希腊人错了，古典并不是完美的</strong></li>
<li><strong>自以为特别的我们在宇宙中其实很普通</strong></li>
</ul>
<p>好在，那个时代的人并没有因为日心说、进化论之类的发现而妄自菲薄，贬低自己的重要性。相反，他们认为，如果人们能够借由理性，探索出整个自然体系的运作规律、用数学模型精确表达，再将这些成果反馈到人类生活上，人类就会发生巨大的改变。这种渴望，成为了启蒙运动的原动力。</p>
<h2 id=" 启蒙运动 ">启蒙运动</h2>
<p>启蒙运动于 18 世纪从法国开始，其目的是<strong>弘扬理性，用理性改造神学、政府和社会观念</strong>。</p>
<p>启蒙运动时期的人们认为，当时的法国有两大非理性势力。其一是教会。教会到处宣传神迹故事，控制人们的思想，威胁他们说如果不听话就要去地狱受苦。其二是法国国王。国王说自己是受上帝神谕管理这个国家的，质疑王权就是违反教义。（奉天承运什么的……）</p>
<p>启蒙运动过程中，有一部百科全书被人们汇总出来。它是第一部现代意义上的百科全书。其<strong>将理性运用于一切事物，将神、宗教和其他概念并列于同一个层级</strong>。这传达出一个信息：<strong>宗教是迷信</strong>。</p>
<p>从文艺复兴到宗教改革，从科学革命到启蒙运动，曾经主导欧洲社会的基督教会地位被不断削弱，欧洲走上了理性、进步的道路。</p>
]]></content>
    <summary type="html"><![CDATA[<p><a href="/2014/12/30/history-of-europe-01/">上一次</a>讲到欧洲文明发端的三股力量和古典、中世纪和近代在事件和时间上的划分。今次写一写和思想有关的东西。</p>
<p>上述三股力量组成的混合体经历了长达一千年的中世纪时期。然而，尽管持续时间很长，这个混合体内部却并不稳定。伴随着文艺复兴的开始，从公元 1400 年左右开始，这个混合体逐渐崩毁，并开始建立起新的秩序。</p>
]]></summary>
    
      <category term="History" scheme="http://liam0205.me/tags/History/"/>
    
      <category term="Europe" scheme="http://liam0205.me/tags/Europe/"/>
    
      <category term="Christianity" scheme="http://liam0205.me/tags/Christianity/"/>
    
      <category term="God" scheme="http://liam0205.me/tags/God/"/>
    
      <category term="Reason" scheme="http://liam0205.me/tags/Reason/"/>
    
      <category term="Science" scheme="http://liam0205.me/tags/Science/"/>
    
      <category term="Romantic" scheme="http://liam0205.me/tags/Romantic/"/>
    
      <category term="Literature and Social Sciences" scheme="http://liam0205.me/categories/Literature%20and%20Social%20Sciences/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[欧洲史·一：欧洲文明开端的三股力量]]></title>
    <link href="http://liam0205.me/2014/12/30/history-of-europe-01/"/>
    <id>http://liam0205.me/2014/12/30/history-of-europe-01/</id>
    <published>2014-12-30T15:26:43.000Z</published>
    <updated>2014-12-30T15:29:09.000Z</updated>
    <content type="html"><![CDATA[<p>欧洲文明的发端，有三股力量：</p>
<ol>
<li>古希腊和古罗马的科学文化；</li>
<li>作为犹太民族宗教的分支的基督教；</li>
<li>征服了罗马帝国的日耳曼战士文化。</li>
</ol>
<a id="more"></a>

<h2 id=" 希腊和罗马 ">希腊和罗马</h2>
<p>一句话概括的话，希腊人在科学文化上极其聪明；而罗马人则相对更加骁勇善战，治国、治军、工程建筑比希腊人更优秀。</p>
<p>希腊人的聪明不需多说：哲学、艺术、文学、数学、科学、医学、政治，这些学科的源头都可以追溯到希腊。现代数学中，随处可见的「希腊字母」，实际上也是对此的一种「纪念」。</p>
<p>罗马人的骁勇也不需多说：古罗马的版图疆域横跨亚欧非，环绕整个地中海。</p>
<p>这样一来的结果就是，罗马人统治了欧洲，但是罗马人却以懂的希腊的语言和文化为荣。</p>
<h2 id=" 基督教的力量 ">基督教的力量</h2>
<p>基督教是犹太教的一个分支。</p>
<p>在犹太人的眼里，「上帝」是唯一的神，而自己的族群（犹太人）则是上帝的选民。此外，犹太人相信遵守上帝的条律，也就是上帝借由「摩西」的口说出来的「摩西十诫」，就能得到上帝的优待。摩西十诫的要求实际上是一种道德的约束，这些约束在犹太人的发展中逐渐成为律法。</p>
<p>犹太教的一些特点和古希腊和古罗马人的信仰是有很多不同的。首先，犹太教只承认耶和华为唯一的真神；其次，犹太教中，道德和律法是密不可分的，古希腊和古罗马却非是如此（希腊神话里的神各种乱伦什么的）。</p>
<p>耶稣是一个犹太人。在耶稣传道的时候，巴勒斯坦已经被罗马帝国纳入版图。耶稣在传道过程中，修改、发扬了犹太教的教义；特别是，耶稣把犹太人严苛的道德训诫转化成了「宇宙大爱」。</p>
<blockquote>
<p>大家都说：「你应当爱你的亲人，应当恨你的仇人」。<br>我却要说：「你们应当爱你的仇人」。——《马太福音书》</p>
</blockquote>
<p>由于耶稣作为讲道人传播的教义与犹太教的教义有相悖的地方，所以犹太教的领导人和罗马帝国练手杀死了耶稣——将他钉在十字架上。</p>
<p>耶稣的死留下了一个分歧，即：只有先变成犹太人，才可以信奉基督教；还是承认耶稣关于「爱」的教会凌驾与一切之上，人人都可以信奉基督教？如果前一个派系获得胜利，那么如今的基督教将只是犹太教的一个小小分支；而显然，后一个派系获得了胜利。</p>
<h2 id=" 日耳曼民族 ">日耳曼民族</h2>
<p>日耳曼民族最开始居于罗马帝国的北方。日耳曼人骁勇善战，甚至可以说是「为了打仗而生」：日耳曼人认为「可以用流血去换得的东西，用流汗这样的方式去换得，是没骨气的表现，是下等人才会做的事情」。</p>
<p>从公元 400 年之后开始，日耳曼人开始入侵罗马帝国；而到了公元 476 年前后，这样的蛮族取代了整个罗马帝国。</p>
<h2 id=" 三者的联结 ">三者的联结</h2>
<p>对于犹太人，罗马人只是把他们当做是一群稀奇古怪的人，所以对信奉犹太教的人，作为统治者的罗马人并不怎么关心。但是在罗马人眼里，信奉基督教的人是一群反动分子——因为他们认为上帝是唯一的神，而不愿意对君主行礼——欲要除之而后快。</p>
<p>就这样，罗马人对基督教打压了三百多年。</p>
<p>不过，在公元 313 年，<strong>君士坦丁大帝</strong>公开表示支持基督教会。于是基督教成为了罗马帝国正式而唯一的宗教，基督教的发展走上正轨。于是，<strong>罗马帝国变成了基督教的天下</strong>。</p>
<p>这时候的基督教，在「地下工作」的三四百年间，发展出了自己的法度并设有法庭和监狱；教会也同时掌管婚姻、继承和税收。基督教会俨然是「第二个政府」。在罗马帝国灭亡之后，基督教会保留了下来。教皇和君主平起平坐，管理文武百官。二者结合，<strong>基督教会变成了罗马人的教会</strong>。</p>
<p>与此同时，基督教会在罗马帝国的灭亡过程中，保留了相当的古希腊和古罗马的科学文化技术。教会的人，利用这些先进的科技文化，对自己的教义进行解读，以维护自己的权利。诚然，基督教曲解了相当的科学成就，但是客观上，<strong>基督教将古希腊和古罗马的文明保存了下来</strong>。</p>
<p>日耳曼蛮族在侵略罗马帝国的过程中逐渐发现一个棘手的问题：他们目不识丁，不懂得如何统治自己的国家。日耳曼民族的首领在打仗的过程中，化身为国王，将征服的土地分给手下的士兵；这些士兵化身为贵族，条件是在过往需要用兵的时候要出兵。</p>
<p>基督教的教主对国王表示自己并不需要土地，避免了与国王和贵族的冲突；同时表示愿意帮助管理国家，赢得了国王的支持。同时，主教们对士兵说，「如果你认可基督教的上帝，那么就能变得更勇武」。最终，<strong>日耳曼蛮族支持基督教</strong>。</p>
<h2 id=" 小结 ">小结</h2>
<p>从古希腊和古罗马开始，到罗马帝国覆灭，这段时间称为<strong>古典时期</strong>；从这三者的联结开始，到 14 世纪三者联结的崩毁，称为<strong>中世纪</strong>；中世纪之后则称为<strong>近代</strong>。</p>
<h2 id=" 番外 ">番外</h2>
<p>教会虽然最终称为了日耳曼蛮族的搭档，但是基督教并不是一个好战的宗教。虽然在先后和罗马、日耳曼民族的合作中变得渐渐支持「正义的战争」，但是却依旧不能接受日耳曼民族的好战的价值观。</p>
<p>不过日耳曼蛮族毕竟目不识丁，妥妥地被继承了希腊罗马科技文化的教会坑了。</p>
<p>教会鼓励他们对战斗的热爱，却改造他们的思想，让他们只参与「正义的战斗」。而何为正义，则全凭教会说了算。比如教会鼓励十字军东征，去夺回陷入伊斯兰教手中的东方的圣地。</p>
<p>同时，教会也要求骑士尊重出身贵族的女士，保护她们、敬重他们。</p>
<p>在骑士绝迹之后，这些被教会改造的中世纪遗风转化成为了所谓的「绅士风度」。</p>
]]></content>
    <summary type="html"><![CDATA[<p>欧洲文明的发端，有三股力量：</p>
<ol>
<li>古希腊和古罗马的科学文化；</li>
<li>作为犹太民族宗教的分支的基督教；</li>
<li>征服了罗马帝国的日耳曼战士文化。</li>
</ol>
]]></summary>
    
      <category term="History" scheme="http://liam0205.me/tags/History/"/>
    
      <category term="Europe" scheme="http://liam0205.me/tags/Europe/"/>
    
      <category term="Greece" scheme="http://liam0205.me/tags/Greece/"/>
    
      <category term="Rome" scheme="http://liam0205.me/tags/Rome/"/>
    
      <category term="Germanic" scheme="http://liam0205.me/tags/Germanic/"/>
    
      <category term="Christianity" scheme="http://liam0205.me/tags/Christianity/"/>
    
      <category term="Literature and Social Sciences" scheme="http://liam0205.me/categories/Literature%20and%20Social%20Sciences/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[订制 Sublime Text 下 LaTeXTools 插件的编译脚本]]></title>
    <link href="http://liam0205.me/2014/12/14/advanced-builder-latextools/"/>
    <id>http://liam0205.me/2014/12/14/advanced-builder-latextools/</id>
    <published>2014-12-14T10:15:34.000Z</published>
    <updated>2014-12-14T12:25:13.000Z</updated>
    <content type="html"><![CDATA[<p><a href="https://github.com/SublimeText/LaTeXTools" target="_blank">LaTeXTools</a> 是 <a href="http://www.sublimetext.com" target="_blank">Sublime Text</a> 上的一个插件，用以增强在 Sublime Text 上编辑和编译 LaTeX 文档的体验。但是其自带的编译脚本比较难用，缺点如下：</p>
<ul>
<li>调用 LaTeXmk 或者 TeXify，多次编译，速度缓慢，难以切换。</li>
<li>无法在编译时方便地添加命令行参数，导致依赖 <code>\write18</code> 命令的宏包（比如 <code>minted</code>）无法使用。</li>
</ul>
<p>为了解决这个问题，我自己写了一个编译脚本，命名为 <code>advancedBuilder.py</code>。</p>
<a id="more"></a>

<h2 id=" 安装方法 ">安装方法</h2>
<ul>
<li>在<a href="/attachment/LaTeX-useful-tools/advancedBuilder.py">这里</a>下载编译脚本；</li>
<li>打开 Sublime Text 目录；</li>
<li>将脚本拷贝至 <code>./Packages/LaTeXTools/builders/</code>；</li>
<li>编辑 <code>./Packages/User/LaTeXTools.sublime-settings</code>，将 <code>&quot;builder&quot;</code> 值从原来的 <code>traditional</code> 改为 <code>advanced</code>，即：<code>&quot;builder&quot;: &quot;advanced&quot;</code>；</li>
<li>重启 Sublime Text。</li>
</ul>
<h2 id=" 使用方法 ">使用方法</h2>
<p>基本的使用方法和原本的 <code>traditionalBuilder.py</code> 相同，即使用快捷键 <code>Ctrl + B</code> 编译（Mac OS X 是 <code>CMD + B</code>）。但在文档开头的注释中，增加了更多的用法。</p>
<h3 id=" 改变编译流程 ">改变编译流程</h3>
<p>可以在主文档开头的注释中，使用下列语法改变编译流程。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="comment">%!TEX builder = BUILDER</span>
</pre></td></tr></table></figure>



<p>其中 <code>BUILDER</code> 的可选值有：</p>
<ul>
<li><code>SIMPLE</code></li>
<li><code>LATEXMK</code></li>
<li><code>TEXIFY</code></li>
</ul>
<p>大小写不论，默认是 <code>SIMPLE</code>，即只编译一遍。</p>
<h3 id=" 选择编译引擎 ">选择编译引擎</h3>
<blockquote>
<p>此功能继承自默认编译脚本，有增强。</p>
</blockquote>
<p>可以在主文档开头的注释中，使用下列语法改变编译引擎。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="comment">%!TEX program = PROGRAM</span>
</pre></td></tr></table></figure>



<p>其中 <code>PROGRAM</code> 的可选值有：</p>
<ul>
<li><code>pdflatex</code></li>
<li><code>xelatex</code></li>
<li><code>lualatex</code></li>
<li><code>platex-ng</code></li>
<li><code>pdftex</code></li>
<li><code>xetex</code></li>
<li><code>luatex</code></li>
<li><code>ptex-ng</code></li>
</ul>
<p>大小写敏感，默认值是 <code>pdflatex</code>。</p>
<h3 id=" 选择编译参数 ">选择编译参数</h3>
<p>可以在主文档开头的注释中，使用下列语法添加编译参数。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="comment">%!TEX option = OPTION</span>
</pre></td></tr></table></figure>



<p>其中 <code>OPTION</code> 的可选值为对 <code>PROGRAM</code> 合法的任意参数。大小写敏感，默认为空。</p>
<p>另外，强制启动 <code>-interaction=nonstopmode</code> 和 <code>-synctex=1</code> 两个参数，不允许更改。</p>
<h3 id=" 指定主文档 ">指定主文档</h3>
<blockquote>
<p>此功能完整继承自默认编译脚本。</p>
</blockquote>
<p>可以在子文档的开头注释中，使用下列语法指定主文档。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="comment">%!TEX root = ROOT</span>
</pre></td></tr></table></figure>



<p>其中 <code>ROOT</code> 为主文档相对当前子文档的路径。指定主文档之后，可以在子文档中直接使用快捷键编译主文档，而不用将 Sublime Text 标签页切换到主文档再进行编译。</p>
<h2 id=" 示例 ">示例</h2>
<figure class="highlight tex"><figcaption><span>foo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
Hello world!
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>对应的命令行为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>pdflatex <span class="attribute">-interaction</span><span class="subst">=</span>nonstopmode <span class="attribute">-synctex</span><span class="subst">=</span><span class="number">1</span>  foo<span class="built_in">.</span>tex
</pre></td></tr></table></figure>



<hr>
<figure class="highlight tex"><figcaption><span>foo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="comment">%!TEX builder = latexmk</span>
<span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
Hello world!
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>对应的命令行为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>latexmk <span class="attribute">-cd</span> <span class="attribute">-e</span> <span class="variable">$pdflatex</span> <span class="subst">=</span> <span class="string">'pdflatex -interaction=nonstopmode -synctex=1  %S %O'</span> <span class="attribute">-f</span> <span class="attribute">-pdf</span> foo<span class="built_in">.</span>tex
</pre></td></tr></table></figure>



<hr>
<figure class="highlight tex"><figcaption><span>foo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="comment">%!TEX builder = latexmk</span>
<span class="comment">%!TEX program = xelatex</span>
<span class="comment">%!TEX option = -shell-escape</span>
<span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
Hello world!
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>对应的命令行为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>latexmk <span class="attribute">-cd</span> <span class="attribute">-e</span> <span class="variable">$pdflatex</span> <span class="subst">=</span> <span class="string">'xelatex -interaction=nonstopmode -synctex=1 -shell-escape %S %O'</span> <span class="attribute">-f</span> <span class="attribute">-pdf</span>
</pre></td></tr></table></figure>



<hr>
<figure class="highlight tex"><figcaption><span>foo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="comment">%!TEX builder = latexmk</span>
<span class="comment">%!TEX program = xelatex</span>
<span class="comment">%!TEX option = -shell-escape</span>
<span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\input</span><span class="special">{</span>bar.tex<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>





<figure class="highlight tex"><figcaption><span>bar </span></figcaption><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="comment">%!TEX root = foo.tex</span>
Hello world!
</pre></td></tr></table></figure>



<p>在 <code>bar.tex</code> 的窗口编译，命令行为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>latexmk <span class="attribute">-cd</span> <span class="attribute">-e</span> <span class="variable">$pdflatex</span> <span class="subst">=</span> <span class="string">'xelatex -interaction=nonstopmode -synctex=1 -shell-escape %S %O'</span> <span class="attribute">-f</span> <span class="attribute">-pdf</span>
</pre></td></tr></table></figure>


]]></content>
    <summary type="html"><![CDATA[<p><a href="https://github.com/SublimeText/LaTeXTools" target="_blank">LaTeXTools</a> 是 <a href="http://www.sublimetext.com" target="_blank">Sublime Text</a> 上的一个插件，用以增强在 Sublime Text 上编辑和编译 LaTeX 文档的体验。但是其自带的编译脚本比较难用，缺点如下：</p>
<ul>
<li>调用 LaTeXmk 或者 TeXify，多次编译，速度缓慢，难以切换。</li>
<li>无法在编译时方便地添加命令行参数，导致依赖 <code>\write18</code> 命令的宏包（比如 <code>minted</code>）无法使用。</li>
</ul>
<p>为了解决这个问题，我自己写了一个编译脚本，命名为 <code>advancedBuilder.py</code>。</p>
]]></summary>
    
      <category term="LaTeXTools" scheme="http://liam0205.me/tags/LaTeXTools/"/>
    
      <category term="Python" scheme="http://liam0205.me/tags/Python/"/>
    
      <category term="Compile" scheme="http://liam0205.me/tags/Compile/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[日文 LaTeX 系统介绍 - 最简示例]]></title>
    <link href="http://liam0205.me/2014/12/11/ptex-intro-and-tutorial-03/"/>
    <id>http://liam0205.me/2014/12/11/ptex-intro-and-tutorial-03/</id>
    <published>2014-12-11T04:13:13.000Z</published>
    <updated>2014-12-11T06:19:52.000Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>本文为译文，原文载于<a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-3-simple-documents/" target="_blank">这里</a>。欢迎关注本系列的文章。</p>
</blockquote>
<p><a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-2-characters-and-encodings/" target="_blank">上一篇文章</a>（<a href="http://liam0205.me/2014/12/08/ptex-intro-and-tutorial-02/">译文</a>）我们探讨了关于字符集和编码的一些细节，今次我们继续讨论如何在 LaTeX 中书写日文。今天的内容需要动手操作试试，要用不同的引擎和宏包写一些 Hello world 类型的文档。</p>
<p><img src="/images/pTeX-intro/nihongo-latex.jpg" alt=""></p>
<p>今天的内容同样会涉及到一些配置 TeX 环境的内容，会讲一讲如何在 <a href="http://tug.org/texlive/" target="_blank">TeX Live</a> 里配置书写日文的环境。</p>
<a id="more"></a>

<h2 id=" 配置日文 _TeX_ 环境 ">配置日文 TeX 环境</h2>
<p>我们假设，你已经在计算机上安装好了类似 TeX Live 2014 的 TeX 系统。你可以在下列 TeX 系统中选择其一安装。</p>
<ul>
<li>TeX Live 的原始版本 (Upstream TeX Live installation) - 完整的安装步骤，请参考 <a href="http://tug.org/texlive/doc/texlive-zh-cn/texlive-zh-cn.pdf" target="_blank">TeX Live 的文档（中文版）</a>的第三章。对于 <a href="http://tug.org/texlive/quickinstall.html" target="_blank">Linux</a> 和 <a href="http://tug.org/texlive/windows.html" target="_blank">Windows</a> 系统，也可以参照相应的快速安装教程。对于 Mac OS X 的用户，则建议安装基于 TeX Live 的 <a href="http://tug.org/mactex/" target="_blank">MacTeX</a>。</li>
<li>发行版里的 TeX Live (Distribution’s TeX Live) - 具体的安装取决于你使用的发行版。如果你用的是 Debian/jessie 或者 Debian/sid，那么你只需要运行 <code>apt-get install texlive-full</code> 即可。其他发行版 (Fedora, RedHat, SuSE) 的用户请注意检查发行版里当前的 TeX Live 版本。在老版本的环境下，后文中的例子可能无法得到预期的结果。</li>
<li>W32TeX - <a href="http://w32tex.org/index-zh.html" target="_blank">W32TeX</a> 是 Akira KAKUTO 针对 Windows 系统制作的 TeX 发行版，其中的宏包也专门为 Windows 系统筛选过。W32TeX 对日文的配置可能是最周全的，不过我没有亲身体验过。</li>
<li>其他 TeX 发行版 - <a href="http://miktex.org/" target="_blank">MiKTeX</a> 是另一个重要的 TeX 发行版。MiKTeX 是 Windows 平台上高度集成的优秀发行版。不过因为打包和依赖脚本的差异，特别是涉及到 <code>udpmap</code> 的部分与 TeX Live 完全不同，MiKTeX 在我手头的一些设备上并不能很好地运行。</li>
</ul>
<p>我的建议是，如果你的发行版足够新，那最好使用软件源里的 TeX Live；不然的话最好是使用 TUG 上的 TeX Live，包括 MacTeX。</p>
<h2 id=" 最简示例 ">最简示例</h2>
<p>言归正传。接下来我们来写几个「Hello world」文档。当然，「Hello world」这几个字母里并没有日文字，所以文章的正文部分看起来会是这个样子：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\LaTeX</span> で日本語を書きましょう！
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>在进行下一步之前，有必要说一下关于编码的问题。请按以下规则，在保存文件的时候选择正确的编码：</p>
<ul>
<li>Unix-like 系统以及 Mac OS X 系统：总是保存为 UTF-8 编码</li>
<li>Windows 系统：在测试 pLaTeX 的时候使用 ShiftJIS 编码，其他时候使用 UTF-8 编码</li>
</ul>
<p>这样做的原因在于：在 Windows 系统上，pTeX 以 ShiftJIS 编码作为默认编码；在其他系统上以 UTF-8 编码作为默认编码。当然，你也可以在 Windows 上把 pLaTeX 的测试文档以 UTF-8 编码保存，但是在编译的时候你得加上 <code>-kanji utf8</code> 这样的参数。</p>
<h3 id="pLaTeX_ 以及 _upLaTeX">pLaTeX 以及 upLaTeX</h3>
<p>这是最简单的情况，我们只需要加上 <code>\documentclass</code> 就好了。</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\LaTeX</span> で日本語を書きましょう！
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>以正确的编码将其保存为 <code>hello-ptex.tex</code>，然后运行 <code>platex</code>，UTF-8 编码的控制台会有类似于如下的输出：</p>
<figure class="highlight text"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre>$ platex hello-ptex.tex
This <span class="keyword">is</span> e-pTeX, Version <span class="number">3.14159265</span>-p3<span class="number">.5</span>-<span class="number">130605</span>-<span class="number">2.6</span> (utf8.euc) (TeX Live <span class="number">2014</span>) (preloaded format=platex)
 restricted \write18 enabled.
entering extended mode
(./hello-ptex.tex
pLaTeX2e &lt;<span class="number">2006</span>/<span class="number">11</span>/<span class="number">10</span>&gt; (based <span class="function_start"><span class="keyword">on</span></span> LaTeX2e &lt;<span class="number">2014</span>/<span class="number">05</span>/<span class="number">01</span>&gt; patch level <span class="number">0</span>)
Babel &lt;<span class="number">3.9</span>k&gt; <span class="keyword">and</span> hyphenation patterns <span class="keyword">for</span> <span class="number">79</span> languages loaded.
(/home/norbert/tl/<span class="number">2014</span>/texmf-dist/tex/latex/base/article.cls
Document Class: article <span class="number">2007</span>/<span class="number">10</span>/<span class="number">19</span> v1<span class="number">.4</span>h Standard LaTeX document <span class="type">class</span>
(/home/norbert/tl/<span class="number">2014</span>/texmf-dist/tex/latex/base/size10.clo)) (./hello-ptex.aux
) [<span class="number">1</span>] (./hello-ptex.aux) )
Output written <span class="function_start"><span class="keyword">on</span></span> hello-ptex.dvi (<span class="number">1</span> page, <span class="number">384</span> bytes).
Transcript written <span class="function_start"><span class="keyword">on</span></span> hello-ptex.<span class="command">log</span>.
</pre></td></tr></table></figure>



<p>Windows 系统上的输出与此类似，只不过在版本号后面的不是 <code>utf8.euc</code> 而是 <code>sjis</code>。</p>
<p>如你所见，输出结果是一个 DVI 文件。注意，此处<strong>不要</strong>使用 <code>dvips</code> 将其转换为 PostScript 文件，<code>dvips</code> 也许能够工作，但是 PS 文件却无法正常显示；请总是使用 <code>dvipdfmx</code> 将 pTeX/upTeX 输出的 DVI 文件转换为 PDF 文件。</p>
<p>因此，我们输入命令</p>
<figure class="highlight text"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>$ dvipdfmx hello<span class="attribute">-ptex</span><span class="built_in">.</span>dvi
hello<span class="attribute">-ptex</span><span class="built_in">.</span>dvi <span class="subst">-&gt; </span>hello<span class="attribute">-ptex</span><span class="built_in">.</span>pdf
<span class="preprocessor">[</span><span class="number">1</span><span class="preprocessor">]</span><span class="markup">
7636 bytes written</span>
</pre></td></tr></table></figure>



<p>接下来，使用 PDF 阅读器打开得到的 PDF 文档，效果类似于下：</p>
<p><img src="/images/pTeX-intro/hello-ptex.jpg" alt=" 输出效果 "></p>
<p>如果觉得字体效果看起来稍有不同，也暂时不用担心，之后对此会有解释。但不论如何，你应该能看到日文字符，不然就说明有哪里错了。</p>
<p>类似的步骤在 upTeX 下同样奏效：</p>
<figure class="highlight text"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre>$ uplatex hello-ptex<span class="preprocessor">.tex</span>
This is e-upTeX, Version <span class="number">3.14159265</span>-p3<span class="number">.5</span>-u1<span class="number">.11</span>-<span class="number">130605</span>-<span class="number">2.6</span> (utf8<span class="preprocessor">.uptex</span>) (TeX Live <span class="number">2014</span>) (preloaded format=uplatex)
 restricted \write18 enabled.
entering extended mode
(./hello-ptex<span class="preprocessor">.tex</span>
pLaTeX2e &lt;<span class="number">2011</span>/<span class="number">05</span>/<span class="number">07</span>u00&gt;+<span class="number">0</span> (based on LaTeX2e &lt;<span class="number">2014</span>/<span class="number">05</span>/<span class="number">01</span>&gt; patch level <span class="number">0</span>)
Babel &lt;<span class="number">3.9</span>k&gt; <span class="keyword">and</span> hyphenation patterns for <span class="number">79</span> languages loaded.
(/home/norbert/tl/<span class="number">2014</span>/texmf-dist/tex/latex/base/article<span class="preprocessor">.cls</span>
Document Class: article <span class="number">2007</span>/<span class="number">10</span>/<span class="number">19</span> v1<span class="number">.4</span>h Standard LaTeX document class
(/home/norbert/tl/<span class="number">2014</span>/texmf-dist/tex/latex/base/size10<span class="preprocessor">.clo</span>)) (./hello-ptex<span class="preprocessor">.aux</span>
) [<span class="number">1</span>] (./hello-ptex<span class="preprocessor">.aux</span>) )
Output written on hello-ptex<span class="preprocessor">.dvi</span> (<span class="number">1</span> page, <span class="number">380</span> bytes).
Transcript written on hello-ptex<span class="preprocessor">.log</span>.
$ dvipdfmx hello-ptex<span class="preprocessor">.dvi</span>
hello-ptex<span class="preprocessor">.dvi</span> -&gt; hello-ptex<span class="preprocessor">.pdf</span>
[<span class="number">1</span>]
<span class="number">7638</span> bytes written
</pre></td></tr></table></figure>



<p>输出结果与之前应当完全相同。</p>
<p>多简单啊~</p>
<h3 id="XeLaTeX">XeLaTeX</h3>
<p>如果你用 XeLaTeX 编译同样的代码，输出结果里就不会有日文字符。这里我们要多写一点代码。这里我会展示使用 <a href="http://ctan.org/pkg/xecjk" target="_blank">xeCJK</a> 和 <a href="http://ctan.org/pkg/zxjatype" target="_blank">ZXjatype</a> 的最简示例。这两个宏包在 TeX Live 里都有，你可以选择其一。</p>
<p>不管你用哪个宏包，你都得选择一个日文字体，不然的话日文字符就不会输出。</p>
<h4 id="xeCJK">xeCJK</h4>
<p>对于 xeCJK 来说，你得这么写：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>xeCJK<span class="special">}</span>
<span class="command">\setCJKmainfont</span><span class="special">{</span>ipaexm.ttf<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\LaTeX</span> で日本語を書きましょう！
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>将其以 UTF-8 编码保存为 <code>hello-xetex.tex</code>，之后运行 <code>xelatex</code>:</p>
<figure class="highlight text"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="variable">$ </span>xelatex hello-xetex.tex
<span class="constant">This</span> is <span class="constant">XeTeX</span>, <span class="constant">Version</span> <span class="number">3.14159265</span>-<span class="number">2.6</span>-<span class="number">0</span>.<span class="number">99991</span> (<span class="constant">TeX</span> <span class="constant">Live</span> <span class="number">2014</span>) (preloaded format=xelatex)
 restricted \write18 enabled.
entering extended mode
(./hello-xetex.tex
<span class="constant">LaTeX2e</span> &lt;<span class="number">2014</span>/<span class="number">05</span>/<span class="number">01</span>&gt;
<span class="constant">Babel</span> &lt;<span class="number">3.9</span>k&gt; <span class="keyword">and</span> hyphenation patterns <span class="keyword">for</span> <span class="number">79</span> languages loaded.
(<span class="regexp">/home/norbert</span><span class="regexp">/tl/</span><span class="number">2014</span>/texmf-dist/tex/latex/base/article.cls
<span class="constant">Document</span> <span class="constant">Class</span><span class="symbol">:</span> article <span class="number">2007</span>/<span class="number">10</span>/<span class="number">19</span> v1.<span class="number">4</span>h <span class="constant">Standard</span> <span class="constant">LaTeX</span> document <span class="class"><span class="keyword">class</span></span>
(<span class="regexp">/home/norbert</span><span class="regexp">/tl/</span><span class="number">2014</span>/texmf-dist/tex/latex/base/size1<span class="number">0</span>.clo))
(<span class="regexp">/home/norbert</span><span class="regexp">/tl/</span><span class="number">2014</span>/texmf-dist/tex/xelatex/xecjk/xeCJK.sty
(<span class="regexp">/home/norbert</span><span class="regexp">/tl/</span><span class="number">2014</span>/texmf-dist/tex/latex/l3kernel/expl3.sty
.....
(./hello-xetex.aux) (<span class="regexp">/home/norbert</span><span class="regexp">/tl/</span><span class="number">2014</span>/texmf-dist/tex/latex/tipa/t3cmr.fd)
[<span class="number">1</span>] (./hello-xetex.aux) )
<span class="constant">Output</span> written on hello-xetex.pdf (<span class="number">1</span> page).
<span class="constant">Transcript</span> written on hello-xetex.log.
</pre></td></tr></table></figure>



<p>直接就能得到 PDF 文档。</p>
<h4 id="ZXjatype">ZXjatype</h4>
<p>对于 ZXjatype 来说，你得这么写：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>zxjatype<span class="special">}</span>
<span class="command">\setjamainfont</span><span class="special">{</span>ipaexm.ttf<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\LaTeX</span> で日本語を書きましょう！
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<h3 id="pdfLaTeX">pdfLaTeX</h3>
<p>接下来，我们看看在 pdfLaTeX 底下怎么使用。pdfTeX 引擎可能是全球范围内使用最广泛的引擎了。这里，我们也将讨论两个宏包的使用方法：Werner Lemberg 的 <a href="http://cjk.ffii.org/" target="_blank">CJK</a> 宏包和 Takayuki Yato 的 <a href="http://www.ctan.org/pkg/bxcjkjatype" target="_blank">BXcjkjatype</a>。</p>
<h4 id="CJK">CJK</h4>
<p>译注：这里作者用了一个很别扭的方式来构建文档，已改用通常习惯的方式。</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>CJKutf8<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>CJK*<span class="special">}</span><span class="special">{</span>UTF8<span class="special">}</span><span class="special">{</span>min<span class="special">}</span>
<span class="command">\LaTeX</span> で日本語を書きましょう！
<span class="command">\end</span><span class="special">{</span>CJK*<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>将其以 UTF-8 编码保存为 <code>hello-cjk.tex</code>，之后运行 <code>pdflatex</code>:</p>
<figure class="highlight text"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre>$ pdflatex hello<span class="attribute">-cjk</span><span class="built_in">.</span>tex
This is pdfTeX, Version <span class="number">3.14159265</span><span class="subst">-</span><span class="number">2.6</span><span class="subst">-</span><span class="number">1.40</span><span class="number">.15</span> (TeX Live <span class="number">2014</span>) (preloaded format<span class="subst">=</span>pdflatex)
 restricted <span class="subst">\</span>write18 enabled<span class="built_in">.</span>
entering extended mode
(<span class="built_in">.</span>/hello<span class="attribute">-cjk</span><span class="built_in">.</span>tex
LaTeX2e <span class="subst">&lt;</span><span class="number">2014</span>/<span class="number">05</span>/<span class="number">01</span><span class="subst">&gt;</span>
Babel <span class="subst">&lt;</span><span class="number">3.9</span>k<span class="subst">&gt;</span> <span class="literal">and</span> hyphenation patterns for <span class="number">79</span> languages loaded<span class="built_in">.</span>
(/home/norbert/tl/<span class="number">2014</span>/texmf<span class="attribute">-dist</span>/tex/latex/base/article<span class="built_in">.</span>cls
Document Class: article <span class="number">2007</span>/<span class="number">10</span>/<span class="number">19</span> v1<span class="number">.4</span>h Standard LaTeX document class
(/home/norbert/tl/<span class="number">2014</span>/texmf<span class="attribute">-dist</span>/tex/latex/base/size10<span class="built_in">.</span>clo))
(/home/norbert/tl/<span class="number">2014</span>/texmf<span class="attribute">-dist</span>/tex/latex/cjk/texinput/CJKutf8<span class="built_in">.</span>sty
<span class="attribute">...</span>
t/fonts/type1/wadalab/dmj/dmjkk<span class="built_in">.</span>pfb<span class="subst">&gt;&lt;</span>/home/norbert/tl/<span class="number">2014</span>/texmf<span class="attribute">-dist</span>/fonts/typ
e1/wadalab/dmj/dmjsy<span class="built_in">.</span>pfb<span class="subst">&gt;</span>
Output written <span class="keyword">on</span> hello<span class="attribute">-cjk</span><span class="built_in">.</span>pdf (<span class="number">1</span> page, <span class="number">29574</span> <span class="built_in">bytes</span>)<span class="built_in">.</span>
Transcript written <span class="keyword">on</span> hello<span class="attribute">-cjk</span><span class="built_in">.</span><span class="keyword">log</span><span class="built_in">.</span>
</pre></td></tr></table></figure>



<p>如果你仔细观察的话，你会发现：LaTeX 几个字母后的空距和之前的输出不大一样。尽管代码看起来有些麻烦，不过，如果你只是想在非日文的文档里嵌入一小段日文，这仍然是个不错的方案。</p>
<p>译者注：实际上，用下面的代码，也能得到正确的 CJK-western 空距。这应该是原作者不熟悉 CJK 导致的。</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>CJKutf8<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>CJKspace<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>CJK*<span class="special">}</span><span class="special">{</span>UTF8<span class="special">}</span><span class="special">{</span>min<span class="special">}</span>
<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span> で日本語を書きましょう！
<span class="command">\end</span><span class="special">{</span>CJK*<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<h4 id="BXcjkjatype">BXcjkjatype</h4>
<p>如果上面的代码看起来十分冗长，那么 BXcjkjatype 则提供了一种更简洁也更好的封装。这里只需要用下面简单的代码就能得到输出了：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">[</span>whole<span class="special">]</span><span class="special">{</span>bxcjkjatype<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\LaTeX</span> で日本語を書きましょう！
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>输出结果和之前 CJK 方式的结果类似。不过，嵌入的字体和之前有所不同。BXcjkjatype 默认使用 IPAex 字体。使用此方式请注意：不要在文档中使用任何非 ASCII 字符。</p>
<h3 id="LuaLaTeX">LuaLaTeX</h3>
<p>LuaTeX 是一个嵌入了 Lua 解释器的新的 TeX 引擎，这使得我们可以使用 Lua 语言来控制和调整许多 TeX 内部的行为。尽管它还不能完全取代 pdfTeX，但是至少拿来输出文档还是可以的。一些日本 TeX 同好为其开发了 <a href="http://ctan.org/pkg/luatexja" target="_blank">LuaTeX-ja</a> 宏包，用以在 LuaTeX 里使用日文。最简示例是这样的：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>luatexja<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\LaTeX</span> で日本語を書きましょう！
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>运行 <code>lualatex</code> 之后，你可能要等上不少时间。这是因为第一次运行 LuaLaTeX 的时候，系统需要刷新字体，耐心等待就好。最终在控制台终端上，你大概会得到下面的输出内容：</p>
<figure class="highlight text"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre>$ lualatex hello<span class="attribute">-luatexja</span><span class="built_in">.</span>tex
This is LuaTeX, Version beta<span class="subst">-</span><span class="number">0.79</span><span class="number">.1</span> (TeX Live <span class="number">2014</span>) (rev <span class="number">4971</span>)
 restricted <span class="subst">\</span>write18 enabled<span class="built_in">.</span>
(<span class="built_in">.</span>/hello<span class="attribute">-luatexja</span><span class="built_in">.</span>tex
LaTeX2e <span class="subst">&lt;</span><span class="number">2014</span>/<span class="number">05</span>/<span class="number">01</span><span class="subst">&gt;</span>
Babel <span class="subst">&lt;</span><span class="number">3.9</span>k<span class="subst">&gt;</span> <span class="literal">and</span> hyphenation patterns for <span class="number">79</span> languages loaded<span class="built_in">.</span>
(/home/norbert/tl/<span class="number">2014</span>/texmf<span class="attribute">-dist</span>/tex/latex/base/article<span class="built_in">.</span>cls
Document Class: article <span class="number">2007</span>/<span class="number">10</span>/<span class="number">19</span> v1<span class="number">.4</span>h Standard LaTeX document class
(/home/norbert/tl/<span class="number">2014</span>/texmf<span class="attribute">-dist</span>/tex/latex/base/size10<span class="built_in">.</span>clo))
(/home/norbert/tl/<span class="number">2014</span>/texmf<span class="attribute">-dist</span>/tex/luatex/luatexja/luatexja<span class="built_in">.</span>sty
<span class="attribute">...</span>
 <span class="number">1923</span> words of node memory still <span class="keyword">in</span> use:
   <span class="number">6</span> hlist, <span class="number">1</span> vlist, <span class="number">3</span> rule, <span class="number">3</span> glue, <span class="number">10</span> kern, <span class="number">1</span> glyph, <span class="number">241</span> attribute, <span class="number">299</span> glue_s
pec, <span class="number">16</span> attribute_list, <span class="number">1</span> write nodes
   avail lists: <span class="number">1</span>:<span class="number">1</span>,<span class="number">2</span>:<span class="number">888</span>,<span class="number">3</span>:<span class="number">5</span>,<span class="number">4</span>:<span class="number">40</span>,<span class="number">5</span>:<span class="number">4</span>,<span class="number">6</span>:<span class="number">25</span>,<span class="number">7</span>:<span class="number">3</span>,<span class="number">9</span>:<span class="number">12</span>
<span class="subst">&lt;&lt;</span>/home/norbert/tl/<span class="number">2014</span>/texmf<span class="attribute">-dist</span>/fonts/type1/<span class="keyword">public</span>/amsfonts/cm/cmr10<span class="built_in">.</span>pfb<span class="subst">&gt;&lt;&lt;</span>/h
ome/norbert/tl/<span class="number">2014</span>/texmf<span class="attribute">-dist</span>/fonts/type1/<span class="keyword">public</span>/amsfonts/cm/cmr7<span class="built_in">.</span>pfb<span class="subst">&gt;</span>
Output written <span class="keyword">on</span> hello<span class="attribute">-luatexja</span><span class="built_in">.</span>pdf (<span class="number">1</span> page, <span class="number">17058</span> <span class="built_in">bytes</span>)<span class="built_in">.</span>
Transcript written <span class="keyword">on</span> hello<span class="attribute">-luatexja</span><span class="built_in">.</span><span class="keyword">log</span><span class="built_in">.</span>
</pre></td></tr></table></figure>



<p>输出结果同样取决于你系统里的默认字体，但和之前的截图应该差不多。</p>
<h2 id=" 总结 ">总结</h2>
<p>文章介绍了在不同 TeX 引擎和宏包下的最简日文示例。如果你能够运行这些示例，那么更复杂的文档你也应该能够运行，你的 TeX 系统完全可以进行日文排版。</p>
<p>不过，仍然还有不少问题需要讨论。比如：字体选择，插图，多语种混排以及非 ASCII 字符的使用。这些我们之后再讨论。</p>
<h2 id=" 译者续 ">译者续</h2>
<p>在 pdfLaTeX 编译的情况下，还有一种排版 CJK 文字的方法。可以使用刘海洋前辈的 <a href="http://www.ctan.org/tex-archive/language/chinese/zhmcjk" target="_blank">zhmCJK</a> 宏包。这个宏包因为一些原因暂时没有收录到 TeX Live 中，不过，这系列文章的作者正好是 TeX Live 的开发者之一，我最近正在和他沟通这件事情。</p>
<p>zhmCJK 宏包提供了类似于 xeCJK 宏包的接口，相应的功能也完全类似。因此可以看做是不能使用 XeLaTeX 而必须使用 pdfLaTeX 的情况下的一个替代。对应于文章中 xeCJK 的例子，最简示例是：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>zhmCJK<span class="special">}</span>
<span class="command">\setCJKmainfont</span><span class="special">{</span>ipaexm.ttf<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span> で日本語を書きましょう！
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>LaTeX 新手可以将宏包内的文件解压，释放到和你的 <code>.tex</code> 文件同目录下；有经验的 LaTeX 使用者，可以按照宏包文档，将宏包文件放在 TEXMF 中的合适位置，然后刷新 TeX 系统。</p>
<p>另外，正如刘海洋前辈和李清前辈（他们是当前 xeCJK 宏包的维护者）<a href="http://www.zhihu.com/question/26705259" target="_blank">所言</a>，xeCJK 虽然取名如此，但实际上只是对中文的支持比较完善。因此用 xeCJK 来排版日文在细节上还是会有一些问题的，特别是对日文排版规则的处理。此外，原作者提到的 ZXjatype 宏包，实际上是在 xeCJK 基础上再开发的结果。由于 xeCJK 的局限，ZXjatype 也不可避免地会有一些问题。</p>
]]></content>
    <summary type="html"><![CDATA[<blockquote>
<p>本文为译文，原文载于<a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-3-simple-documents/" target="_blank">这里</a>。欢迎关注本系列的文章。</p>
</blockquote>
<p><a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-2-characters-and-encodings/" target="_blank">上一篇文章</a>（<a href="http://liam0205.me/2014/12/08/ptex-intro-and-tutorial-02/">译文</a>）我们探讨了关于字符集和编码的一些细节，今次我们继续讨论如何在 LaTeX 中书写日文。今天的内容需要动手操作试试，要用不同的引擎和宏包写一些 Hello world 类型的文档。</p>
<p><img src="/images/pTeX-intro/nihongo-latex.jpg" alt=""></p>
<p>今天的内容同样会涉及到一些配置 TeX 环境的内容，会讲一讲如何在 <a href="http://tug.org/texlive/" target="_blank">TeX Live</a> 里配置书写日文的环境。</p>
]]></summary>
    
      <category term="pTeX" scheme="http://liam0205.me/tags/pTeX/"/>
    
      <category term="Japanese" scheme="http://liam0205.me/tags/Japanese/"/>
    
      <category term="Demo" scheme="http://liam0205.me/tags/Demo/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[日文 LaTeX 系统介绍 - 字符与编码]]></title>
    <link href="http://liam0205.me/2014/12/08/ptex-intro-and-tutorial-02/"/>
    <id>http://liam0205.me/2014/12/08/ptex-intro-and-tutorial-02/</id>
    <published>2014-12-08T07:36:29.000Z</published>
    <updated>2014-12-09T03:29:41.000Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>本文为译文，原文载于<a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-2-characters-and-encodings/" target="_blank">这里</a>。欢迎关注本系列的文章。</p>
</blockquote>
<p><a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-1-introduction/" target="_blank">上一篇文章</a>（<a href="http://liam0205.me/2014/12/07/ptex-intro-and-tutorial-01/">译文</a>）简单介绍了在 LaTeX 中排版日文的一些情况，今次我们会探讨一些关于字符和编码的技术细节。</p>
<p><img src="/images/pTeX-intro/nihongo-latex.jpg" alt=""></p>
<a id="more"></a>

<p>这篇文章我们将讨论字符集和编码。在书写欧洲文字的时候，人们就已经需要用到非 ASCII 字符了；诸如日文这样的有成千上万个表义字符的书写系统，其字符数量更是远超 ASCII 所能涵盖的数量。同时我们也会琢磨一下为什么在日文文档里的转义字符为什么不是反斜线（\），而是日本货币标志（￥）。</p>
<p>首先，我并不精于此道。因此，文中讲解的内容十分简单，并且不可避免地会有谬误。如有发现请指出。</p>
<h2 id=" 字符集和编码 ">字符集和编码</h2>
<p>对于 ASCII 来说，这事儿很简单。比如，在计算机中表示「A」这个字母，我们只需要用 65 这个十进制数来表示即可。并且，65 对应的二进制数，也正是字母「A」在计算机中的样子。因此，对于 ASCII 来说，它既是字符集又是编码。</p>
<p>对于非 ASCII 字符来说，这事儿就变得复杂起来了。</p>
<p>对于欧洲的字符来说可能还好。比如常用的 Latin1 字符集中，字符「Ö」的码位是 214。由于一个字节可以表示 256 个不同的值，所以勉强能装下整个 Latin1 字符集。</p>
<p>但是对于成千上万的日文汉字 (Kanji) 来说，这就不行了。首先需要有一个统一的方式将字形 (glyph) 编号，每个字形对应一个 ID (数字)。然后再寻找一个合适的方式去编码这些字形。</p>
<h3 id=" 字符集标准 ">字符集标准</h3>
<ul>
<li><strong>JIS</strong> - 实践中有一些日本工业标准 (<a href="http://en.wikipedia.org/wiki/Japanese_Industrial_Standard" target="_blank">Japanese Industrial Standards</a>)。比如，JIS X 0201 在 ASCII 字符集的基础上，增加了 64 个半宽 (half-width) 的片假名；又比如，<a href="http://en.wikipedia.org/wiki/JIS_X_0208" target="_blank">JIS X 0208</a> 是最常见的汉字字符集，它包含 6879 个字符，其中有 6355 个汉字，另有 524 个其他类型的字符。</li>
<li><strong>UCS</strong> - 通用字符集 (<a href="http://zh.wikipedia.org/wiki/ 通用字符集 " target="_blank">Universal Character Set</a>) 中包含了近十万个抽象字符，它试图将有史以来所有的字符都包含进来。涉及到日语的部分有一些特殊，对应的标准是统一汉码 (<a href="http://en.wikipedia.org/wiki/Han_unification" target="_blank">Han Unification</a>)，这个字符集将中日韩表意相同的形近字统一映射到一个码位上。</li>
</ul>
<h3 id=" 编码 ">编码</h3>
<p>有了字符集标准，接下来需要考虑如何在计算机中用二进制和字节表示这些字符。编码和字符集是两个不同的概念，但因为总是一起提及，所以经常有人混淆。</p>
<p>对于现代计算机和 TeX 来说，有以下一些常见的编码。其中前三个编码了 JIS 字符集；最后一个编码了 Unicode 字符集。</p>
<ul>
<li>SJIS (<a href="http://zh.wikipedia.org/wiki/Shift_JIS" target="_blank">Shift JIS</a>) - SJIS 编码了 JIS X 0201 和 JIS X 0208 两个字符集。它很好地兼容了 ASCII 和 JIS X 0201，这使得它在老的计算机上工作正常；但是它也有一些奇怪的性质，并因此在一些通用解析器上工作不正常。</li>
<li>JIS X 0202 - 通称 JIS 的编码标准，它编码了 JIS X 0208。这个编码在诸如电子邮件的 7-bit 信道上的传输性能良好；老的 Emacs 也将其当做内部编码。</li>
<li>EUC(-JP) Extanded Unix Code - 实际上是符合 ISO 2022 标准的字符集的编码族。这种编码在日本的 Unix-affine 计算机上流行多年。</li>
<li><a href="http://en.wikipedia.org/wiki/UTF-8" target="_blank">UTF-8</a> - 编码了 UCS 字符集，是 <a href="http://en.wikipedia.org/wiki/Unicode" target="_blank">Unicode 标准</a>的一部分，先行与几乎所有现代计算机操作系统上。</li>
</ul>
<p>最后我们来看一个例子。</p>
<pre><code><span class="keyword">Language</span>
Ä á
日本語
ひらがな
</code></pre><p>注意观察他们在不同编码规则情况下对应的十六进制数据。</p>
<p><strong>UTF-8</strong></p>
<p>第一行的「Language」在 UTF-8 编码中对应的十六进制与 ASCII 完全相同，用一个字节表示一个字符；第二行的注音字母则用两个字节来编码，其中 0x20 是单字节的空格；第三行的日文汉字和第四行的平假名都用三个字符来编码。</p>
<pre><code>4c 61 6e 67 75 61 67 65
c3 84 20 c3 a1
e6 97 a5 e6 9c ac e8 aa 9e
e3 81 b2 e3 82 89 e3 81 8c e3 81 aa
</code></pre><p><strong>SJIS</strong></p>
<p>SJIS 编码就有点意思了。首先，第一行保持相同，与 ASCII 兼容。第二行的「Ä」并不在字符集当中，于是 SJIS 把它当做是「”A」，编码成「0x22 0x41」；另一方面，「á」在字符集当中，SJIS 用三个字节将它编码成「0x81 0x4c 0x61」。注意第一行的编码，「0x4c」是字母「L」，「0x61」是字母「a」。它们连在一起与「á」的第二和第三个字节完全相同。这样「La」的编码就出现了歧义，一些解析器就无法正常工作了。</p>
<p>接下来的日文汉字和平假名分别用两个字节来编码。</p>
<pre><code>4c 61 6e 67 75 61 67 65
22 41 20 81 4c 61
93 fa 96 7b 8c ea
82 d0 82 e7 82 aa 82 c8
</code></pre><p><strong>ISO2022-JP</strong></p>
<p>同样由于「Ä」不在字符集当中，ISO2022-JP 把它当做是「”A」来进行编码；但「á」却花了 9 个字节来编码。同时汉字和平假名的编码方式也是不固定的。</p>
<pre><code><span class="number">4</span>c <span class="number">61</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">75</span> <span class="number">61</span> <span class="number">67</span> <span class="number">65</span>
<span class="number">22</span> <span class="number">41</span> <span class="number">20</span> <span class="number">1</span>b <span class="number">24</span> <span class="number">42</span> <span class="number">21</span> <span class="number">2</span>d <span class="number">1</span>b <span class="number">28</span> <span class="number">42</span> <span class="number">61</span>
<span class="number">1</span>b <span class="number">24</span> <span class="number">42</span> <span class="number">46</span> <span class="number">7</span>c <span class="number">4</span>b <span class="number">5</span>c <span class="number">38</span> <span class="number">6</span>c <span class="number">1</span>b <span class="number">28</span> <span class="number">42</span>
<span class="number">1</span>b <span class="number">24</span> <span class="number">42</span> <span class="number">24</span> <span class="number">52</span> <span class="number">24</span> <span class="number">69</span> <span class="number">24</span> <span class="number">2</span>c <span class="number">24</span> <span class="number">4</span><span class="operator">a</span> <span class="number">1</span>b <span class="number">28</span> <span class="number">42</span>
</code></pre><p><strong>EUC-JP</strong></p>
<p>EUC-JP 编码对应的字符集是 JIS X 0212，比之前的 JIS X 0201 和 JIS X 0208 大得多。这次「Ä」能够正确编码了。两个变音的拉丁字符被分别编码成三个字节；汉字和假名则是两个字节。</p>
<pre><code><span class="number">4</span>c <span class="number">61</span> <span class="number">6</span>e <span class="number">67</span> <span class="number">75</span> <span class="number">61</span> <span class="number">67</span> <span class="number">65</span>
<span class="number">8f</span> aa a3 <span class="number">20</span> <span class="number">8f</span> ab a1
c6 fc cb dc b8 ec
a4 d2 a4 e9 a4 ac a4 ca
</code></pre><p>从这里可以看到，UTF-8 编码汉字和假名需要用到三个字节。因此用 UTF-8 编码来处理文档，得到的文件体积要大上不少。同时，旧有的编码沿用多年，惯性很大。因此 UTF-8 编码在日本用了很多年才得以推广。</p>
<h2 id=" 我的计算机在用什么编码？">我的计算机在用什么编码？</h2>
<p>这取决于你的计算机操作系统。</p>
<ul>
<li>Linux: 大多数情况下，Linux 系统使用 UTF-8 编码。在终端里执行 <code>locale</code> 命令，输出结果中的 <code>LC_CTYPE</code> 字段里可以看到系统语言和使用编码的信息。比如，<code>en_US.utf8</code>。</li>
<li>Mac: 在 OS X 之前，Mac 使用的是苹果公司修改的 SJIS 版本，其名为 MacJapanese。从 OS X 开始，Mac 使用的是 UTF-8。</li>
<li>Windows: 老版本使用 M$ 家修改的 SJIS 版本，其名为 CP932 （代码页 932，简体中文系统则是 CP936)。不过，新版本的 Windows 也有可能使用 UTF-8。</li>
<li>BSD: 据我所知，用的是 UTF-8。</li>
</ul>
<h2 id=" 小结 ">小结</h2>
<p>在 LaTeX 里些日文文档之前，你先要确定你使用的是什么编码。不同的 TeX 引擎对编码支持的情况不同，你应该根据需要选择合适的编码和 TeX 引擎。目前被 TeX 引擎支持最好的编码（译注：原文是字符集）是 UTF-8。新版本的 pTeX 接受 UTF-8 编码；upTeX, XeTeX, LuaTeX 原生支持 UTF-8 编码；使用 BXcjkjatype 时，也应当使用 UTF-8 编码。</p>
<p>不过，不少老版本的文档使用 SJIS 编码。此时你应该使用 pTeX，用 pLaTeX 来编译；或者将他们转换为 UTF-8 编码后使用。</p>
<h2 id=" 关于 _\_ 和 _￥">关于 \ 和 ￥</h2>
<p>以下内容来自维基百科 <a href="http://en.wikipedia.org/wiki/Shift_JIS" target="_blank">ShiftJIS</a> 词条：</p>
<blockquote>
<p>The single-byte characters 0x00 to 0x7F match the ASCII encoding, except for a yen sign (U+00A5) at 0x5C and an overline (U+203E) at 0x7E in place of the ASCII character set’s backslash and tilde respectively.</p>
</blockquote>
<p>也就是说，在 SJIS 中，符号「¥」的编码与 ASCII 里的反斜线「\」的编码相同，都是 0x5C；与此同时，TeX 将 0x5C 当做是转义符。于是，在使用 SJIS 编码的计算机里，TeX 控制序列就都变成了类似 <code>¥hfill</code> 的样子。</p>
<p>下一篇文章，我们将正式开始编写 LaTeX 代码！</p>
<h2 id=" 译者续 ">译者续</h2>
<p>SJIS 在日本的地位和 GBK 在中国的地位差不多。在早期的 Windows 系统里，使用的 CP936 与 GBK 几乎相同。同时，中文 LaTeX 早期的支持方式也都是基于 GBK 编码的。</p>
<p>为了避免不必要的麻烦，我们的口号是：「<strong>珍爱生命，远离 GBK</strong>」。</p>
]]></content>
    <summary type="html"><![CDATA[<blockquote>
<p>本文为译文，原文载于<a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-2-characters-and-encodings/" target="_blank">这里</a>。欢迎关注本系列的文章。</p>
</blockquote>
<p><a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-1-introduction/" target="_blank">上一篇文章</a>（<a href="http://liam0205.me/2014/12/07/ptex-intro-and-tutorial-01/">译文</a>）简单介绍了在 LaTeX 中排版日文的一些情况，今次我们会探讨一些关于字符和编码的技术细节。</p>
<p><img src="/images/pTeX-intro/nihongo-latex.jpg" alt=""></p>
]]></summary>
    
      <category term="pTeX" scheme="http://liam0205.me/tags/pTeX/"/>
    
      <category term="Encoding" scheme="http://liam0205.me/tags/Encoding/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[日文 LaTeX 系统介绍 - 简介]]></title>
    <link href="http://liam0205.me/2014/12/07/ptex-intro-and-tutorial-01/"/>
    <id>http://liam0205.me/2014/12/07/ptex-intro-and-tutorial-01/</id>
    <published>2014-12-07T12:29:35.000Z</published>
    <updated>2014-12-07T14:29:59.000Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>本文为译文，原文载于<a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-1-introduction/" target="_blank">这里</a>。尽请关注本系列的文章。</p>
</blockquote>
<p>对于日本人来说，在 LaTeX 里面写日文很简单。但是由于文档的缺乏，外国人（相对日本）想要这样做就不容易了。更何况日语里面会混合罗马字母、假名、汉字。</p>
<p>这里我想总结一下我自己写日文 LaTeX 文档的经验。这些经验一方面来自我自己的实践，另一方面来自我的日本朋友的各种帮助。系列文章的第一部分简介了日文排版的一些情况，特别是关于 TeX 的介绍。在这里，我会对用于排版日文的 TeX 引擎和宏包做一个简单的比较。</p>
<a id="more"></a>

<h2 id=" 日文书写系统 ">日文书写系统</h2>
<p>日文中至少有四种书写系统：</p>
<ul>
<li>罗马字母</li>
<li>平假名：平假名共有 45 个，一般来说用于连接汉字。</li>
<li>片假名：片假名和平假名一一对应，一般用来音译外文。</li>
<li>日文汉字：来自中文的表意文字，书面语里有很多汉字。</li>
</ul>
<p>通常来说，日文文章里这四种书写系统会混杂在一起。下面的截图来自日文<a href="http://ja.wikipedia.org/wiki/ メインページ " target="_blank">维基百科</a>的「<a href="http://ja.wikipedia.org/wiki/ 日本 " target="_blank">日本</a>」词条。</p>
<p><img src="/images/pTeX-intro/Japanese-Text-Example.png" alt=" 截图：日文维基百科的「日本」词条 "></p>
<p>日文书写系统的的规则繁复。Haruhiko Okumura (奥村 晴彦) 先生对此有过一个不错的<a href="http://ajt.ktug.org/2008/0201okumura.pdf" target="_blank">介绍</a>；如果你想了解详细的规则，可以看<a href="http://www.w3.org/TR/jlreq/" target="_blank">这里</a>。TeX 本身并没有支持这些规则，于是 1987 年 NTT 的 Yasuki Saito (斉藤 康己) 先生编写了 NTT jTeX 这个引擎；1990 年，<a href="http://asciimw.jp/" target="_blank">ASCII 公司</a> 的 Shunji Ohno (大野 俊治) 先生和 Ryoichi Kurasawa (倉沢 良一) 先生修改了 NTT jTeX，增加了出版业所必须的竖排功能，命名为 pTeX (publishing TeX)。对此，Okumura 先生的文章里有详细的叙述。</p>
<h2 id=" 日文排版 ">日文排版</h2>
<p>日本自己开发了 pTeX，但这些年也有其他的一些 TeX 引擎可以用来排版日文。据我所知，有以下一些。</p>
<ul>
<li>e(p)(la)tex: 从原始的 pTeX 而来，增加了 e-TeX 的补丁以适应现代 LaTeX 的需要</li>
<li>up(la)tex: 同样从原始的 pTeX 发展而来，增加了 e-TeX 的补丁并增加了 UTF-8 编码支持</li>
<li>xe(la)tex: 另一个系统，同样支持 UTF-8 编码以及其他一些先进的技术</li>
<li>pdf(la)tex with CJK package: 支持中日韩文字，但已过时</li>
<li>pdf(la)tex with bxcjkjatype package: 一个易用的新宏包，有一些功能上的限制</li>
<li>lua(la)tex with luatex-ja package: 最新的日文支持方式，提供了不少优秀的特性</li>
</ul>
<h2 id=" 需求 ">需求</h2>
<p>在 LaTeX 里书写日文有以下需求。</p>
<ul>
<li>e-TeX 原语：e-TeX 是原始 TeX 的扩展，后逐渐成为主流，现在它的原语成为 LaTeX 强制要求的一部分</li>
<li>日文排版禁则：如前所述</li>
<li>竖排：许多非技术文本都会用到竖排</li>
<li>UTF-8 支持：pTeX 使用的编码不大好，有不少问题，现代计算机大都使用 UTF-8 编码</li>
<li>能够使用商业字体：在文章里能够自由切换字体</li>
<li>插图支持</li>
</ul>
<p>在这里，pTeX 不支持 e-TeX、UTF-8 编码，插图功能孱弱；e-pTeX 完善了 e-TeX 支持，但仍不支持 UTF-8 编码且插图功能依旧孱弱；upTeX 又克服了 UTF-8 编码支持的问题；XeTeX 对竖排的支持能力有限；pdfTeX + CJK 对日文禁则处理不好，也不支持竖排；pdfTeX + bxcjkjatype 对日文禁则处理不好，不支持竖排，也无法比较好地处理商业字体；LuaTeX + LuaTeX-ja 对竖排的支持不甚良好。</p>
<h2 id="（至今为止的）结论 ">（至今为止的）结论</h2>
<p>最近我都在使用 LuaTeX-ja，以下是<strong>我</strong>对此的一些总结。</p>
<ul>
<li>(u)ptex: 如果你想要竖排功能，这是唯一的选择；此外，由于 pTeX 系源自日本，它对日文排版禁则的支持最好</li>
<li>xe(la)tex: 目前功能相对完善的宏包是 <code>xeCJK</code>，但其实只是对中文支持良好；日本有同好对此做了扩展，效果一般</li>
<li>pdf(la)tex + CJK: 过时了，不推荐</li>
<li>pdf(la)tex + bxcjkjatype: 很好用，但是有一个很重要缺点：所有非 ASCII 字符都被当做汉字对待</li>
<li>luatexja: 最打动我的宏包，强烈推荐。</li>
</ul>
<p>下一篇文章里我会介绍一下各种方式底下的最简日文示例。</p>
<p>谢谢！</p>
<h2 id=" 译者续 ">译者续</h2>
<p>马起园 (Clerk Ma) 的 pTeX-ng 是下一代的 pTeX。pTeX-ng 从 Y&amp;Y TeX 发展而来，是纯 C 编写的 TeX 引擎。它带有 e-TeX, pTeX 的补丁，并原生支持 Unicode 编码，对字体支持良好，并且能够直接输出 PDF 文档。pTeX-ng 的前景十分喜人。</p>
]]></content>
    <summary type="html"><![CDATA[<blockquote>
<p>本文为译文，原文载于<a href="http://www.preining.info/blog/2014/12/writing-japanese-in-latex-part-1-introduction/" target="_blank">这里</a>。尽请关注本系列的文章。</p>
</blockquote>
<p>对于日本人来说，在 LaTeX 里面写日文很简单。但是由于文档的缺乏，外国人（相对日本）想要这样做就不容易了。更何况日语里面会混合罗马字母、假名、汉字。</p>
<p>这里我想总结一下我自己写日文 LaTeX 文档的经验。这些经验一方面来自我自己的实践，另一方面来自我的日本朋友的各种帮助。系列文章的第一部分简介了日文排版的一些情况，特别是关于 TeX 的介绍。在这里，我会对用于排版日文的 TeX 引擎和宏包做一个简单的比较。</p>
]]></summary>
    
      <category term="pTeX" scheme="http://liam0205.me/tags/pTeX/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[在 LaTeX 里定义一个类似 proof 的环境]]></title>
    <link href="http://liam0205.me/2014/12/03/how-to-define-a-proof-like-environment/"/>
    <id>http://liam0205.me/2014/12/03/how-to-define-a-proof-like-environment/</id>
    <published>2014-12-03T06:12:57.000Z</published>
    <updated>2014-12-03T06:44:12.000Z</updated>
    <content type="html"><![CDATA[<p>美国数学协会（AMS）是 TeX 发展中的一支重要的力量。AMS 定义的 <code>proof</code> 环境非常好用，能在证明结束的末尾，自动添加一个「证毕」的符号。</p>
<p>有时我们需要类似的环境，比如<a href="http://bbs.ctex.org/forum.php?mod=viewthread&amp;tid=79516" target="_blank">这里</a>的题主希望用两个环境区分「证明」和「解答」，并且都需要自动添加结束符号。这时我们可以仿照 <code>amsthm</code> 宏包的做法，自己定义一套环境。</p>
<a id="more"></a>

<p><code>proof</code> 环境的原始定义是这样的：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="command">\newenvironment</span><span class="special">{</span>proof<span class="special">}</span><span class="special">[</span>1<span class="special">]</span><span class="special">[</span><span class="command">\proofname</span><span class="special">]</span><span class="special">{</span><span class="command">\par</span>
  <span class="command">\pushQED</span><span class="special">{</span><span class="command">\qed</span><span class="special">}</span><span class="comment">%</span>
  <span class="command">\normalfont</span> <span class="command">\topsep</span>6<span class="command">\p</span>@<span class="command">\@</span>plus6<span class="command">\p</span>@<span class="command">\relax</span>
  <span class="command">\trivlist</span>
  <span class="command">\item</span><span class="special">[</span><span class="command">\hskip</span><span class="command">\labelsep</span>
        <span class="command">\itshape</span>
    <span class="special">#</span>1<span class="command">\@</span>addpunct<span class="special">{</span>.<span class="special">}</span><span class="special">]</span><span class="command">\ignorespaces</span>
<span class="special">}</span><span class="special">{</span><span class="command">\popQED</span><span class="command">\endtrivlist</span><span class="command">\@</span>endpefalse<span class="special">}</span>
</pre></td></tr></table></figure>



<p>这里 <code>\pushQED{\qed}</code> 把 <code>\qed</code> 压入了 QED 这个堆栈，然后在环境结束的地方，通过 <code>\popQED</code> 把压入堆栈的最后一个元素弹出来。这样的设计是非常合理的。比如，如果在证明的过程中，需要分别证明两个小的情形，这样就能按照次序依次给出证明的结束符号。此外，证明开始的标题通过 <code>\proofname</code> 来控制。</p>
<p>通过这些分析，我们知道定义一个新的环境，我们需要从两个方面入手。其一是 <code>\proofname</code> 的位置需要改变，其二是压入堆栈的内容需要更改。</p>
<p>下面的代码我们定义了一个名为 <code>\fooname</code> 的宏，来替代 <code>\proofname</code>。</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="command">\providecommand</span><span class="special">{</span><span class="command">\fooname</span><span class="special">}</span><span class="special">{</span>Foo<span class="special">}</span>
</pre></td></tr></table></figure>



<p>下面的代码我们定义了名为 <code>\bxz</code> 的宏，来替换原本压入堆栈的 <code>\qed</code>。其中 <code>\bxz</code> 具体的符号内容用 <code>\bxzsymbol</code> 这个宏来控制。</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="command">\DeclareRobustCommand</span><span class="special">{</span><span class="command">\bxz</span><span class="special">}</span><span class="special">{</span><span class="command">\ifmmode</span> <span class="command">\mathbxz</span>
  <span class="command">\else</span>
    <span class="command">\leavevmode</span><span class="command">\unskip</span><span class="command">\penalty</span>9999 <span class="command">\hbox</span><span class="special">{</span><span class="special">}</span><span class="command">\nobreak</span><span class="command">\hfill</span>
    <span class="command">\quad</span><span class="command">\hbox</span><span class="special">{</span><span class="command">\bxzsymbol</span><span class="special">}</span><span class="comment">%</span>
  <span class="command">\fi</span>
<span class="special">}</span>
<span class="command">\newcommand</span><span class="special">{</span><span class="command">\mathbxz</span><span class="special">}</span><span class="special">{</span><span class="command">\quad</span><span class="command">\hbox</span><span class="special">{</span><span class="command">\bxzsymbol</span><span class="special">}</span><span class="special">}</span>
<span class="command">\providecommand</span><span class="special">{</span><span class="command">\bxzsymbol</span><span class="special">}</span><span class="special">{</span><span class="command">\fbox</span><span class="special">{</span><span class="command">\footnotesize</span> B.X.Z<span class="special">}</span><span class="special">}</span>
</pre></td></tr></table></figure>



<p>最后，重新定义一个名为 <code>foo</code> 的环境。</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="command">\newenvironment</span><span class="special">{</span>foo<span class="special">}</span><span class="special">[</span>1<span class="special">]</span><span class="special">[</span><span class="command">\fooname</span><span class="special">]</span><span class="special">{</span><span class="command">\par</span>
  <span class="command">\pushQED</span><span class="special">{</span><span class="command">\bxz</span><span class="special">}</span><span class="comment">%</span>
  <span class="command">\normalfont</span> <span class="command">\topsep</span>6<span class="command">\p</span>@<span class="command">\@</span>plus6<span class="command">\p</span>@<span class="command">\relax</span>
  <span class="command">\trivlist</span>
  <span class="command">\item</span><span class="special">[</span><span class="command">\hskip</span><span class="command">\labelsep</span>
        <span class="command">\itshape</span>
    <span class="special">#</span>1<span class="command">\@</span>addpunct<span class="special">{</span>.<span class="special">}</span><span class="special">]</span><span class="command">\ignorespaces</span>
<span class="special">}</span><span class="special">{</span><span class="command">\popQED</span><span class="command">\endtrivlist</span><span class="command">\@</span>endpefalse<span class="special">}</span>
</pre></td></tr></table></figure>



<p>完整的测试代码如下：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>amsthm<span class="special">}</span>
<span class="command">\makeatletter</span>
<span class="command">\DeclareRobustCommand</span><span class="special">{</span><span class="command">\bxz</span><span class="special">}</span><span class="special">{</span><span class="command">\ifmmode</span> <span class="command">\mathbxz</span>
  <span class="command">\else</span>
    <span class="command">\leavevmode</span><span class="command">\unskip</span><span class="command">\penalty</span>9999 <span class="command">\hbox</span><span class="special">{</span><span class="special">}</span><span class="command">\nobreak</span><span class="command">\hfill</span>
    <span class="command">\quad</span><span class="command">\hbox</span><span class="special">{</span><span class="command">\bxzsymbol</span><span class="special">}</span><span class="comment">%</span>
  <span class="command">\fi</span>
<span class="special">}</span>
<span class="command">\newcommand</span><span class="special">{</span><span class="command">\mathbxz</span><span class="special">}</span><span class="special">{</span><span class="command">\quad</span><span class="command">\hbox</span><span class="special">{</span><span class="command">\bxzsymbol</span><span class="special">}</span><span class="special">}</span>
<span class="command">\newenvironment</span><span class="special">{</span>foo<span class="special">}</span><span class="special">[</span>1<span class="special">]</span><span class="special">[</span><span class="command">\fooname</span><span class="special">]</span><span class="special">{</span><span class="command">\par</span>
  <span class="command">\pushQED</span><span class="special">{</span><span class="command">\bxz</span><span class="special">}</span><span class="comment">%</span>
  <span class="command">\normalfont</span> <span class="command">\topsep</span>6<span class="command">\p</span>@<span class="command">\@</span>plus6<span class="command">\p</span>@<span class="command">\relax</span>
  <span class="command">\trivlist</span>
  <span class="command">\item</span><span class="special">[</span><span class="command">\hskip</span><span class="command">\labelsep</span>
        <span class="command">\itshape</span>
    <span class="special">#</span>1<span class="command">\@</span>addpunct<span class="special">{</span>.<span class="special">}</span><span class="special">]</span><span class="command">\ignorespaces</span>
<span class="special">}</span><span class="special">{</span><span class="command">\popQED</span><span class="command">\endtrivlist</span><span class="command">\@</span>endpefalse<span class="special">}</span>
<span class="command">\providecommand</span><span class="special">{</span><span class="command">\bxzsymbol</span><span class="special">}</span><span class="special">{</span><span class="command">\fbox</span><span class="special">{</span><span class="command">\footnotesize</span> B.X.Z<span class="special">}</span><span class="special">}</span>
<span class="command">\providecommand</span><span class="special">{</span><span class="command">\fooname</span><span class="special">}</span><span class="special">{</span>Foo<span class="special">}</span>
<span class="command">\makeatother</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>proof<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>foo<span class="special">}</span>
  The foo goes here.
<span class="command">\end</span><span class="special">{</span>foo<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>foo<span class="special">}</span>
  <span class="command">\[</span>
    E = mc^<span class="special">{</span>2<span class="special">}</span>.<span class="command">\qedhere</span>
  <span class="command">\]</span>
<span class="command">\end</span><span class="special">{</span>foo<span class="special">}</span>
This is the conclusion that we need.
<span class="command">\end</span><span class="special">{</span>proof<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p><img src="/images/LaTeX/redefine-proof.png" alt=" 测试代码截图 "></p>
]]></content>
    <summary type="html"><![CDATA[<p>美国数学协会（AMS）是 TeX 发展中的一支重要的力量。AMS 定义的 <code>proof</code> 环境非常好用，能在证明结束的末尾，自动添加一个「证毕」的符号。</p>
<p>有时我们需要类似的环境，比如<a href="http://bbs.ctex.org/forum.php?mod=viewthread&amp;tid=79516" target="_blank">这里</a>的题主希望用两个环境区分「证明」和「解答」，并且都需要自动添加结束符号。这时我们可以仿照 <code>amsthm</code> 宏包的做法，自己定义一套环境。</p>
]]></summary>
    
      <category term="Proof" scheme="http://liam0205.me/tags/Proof/"/>
    
      <category term="Environment" scheme="http://liam0205.me/tags/Environment/"/>
    
      <category term="Macros" scheme="http://liam0205.me/tags/Macros/"/>
    
      <category term="AMS" scheme="http://liam0205.me/tags/AMS/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[在 LaTeX 中使用含有中文的 PDF 书签避免乱码的正确姿势]]></title>
    <link href="http://liam0205.me/2014/11/22/latex-pdf-cjk-bookmarks/"/>
    <id>http://liam0205.me/2014/11/22/latex-pdf-cjk-bookmarks/</id>
    <published>2014-11-22T08:57:54.000Z</published>
    <updated>2014-12-03T15:33:41.000Z</updated>
    <content type="html"><![CDATA[<p>LaTeX 的 <code>hyperref</code> 宏包能够在 PDF 文件里生成 PDF 书签，然而「书签乱码」是困扰很多 LaTeX 使用者的麻烦问题。</p>
<p>早年李树钧和张林波老师共同开发了名为 <a href="http://www.hooklee.com/tex/gbk2uni.zip" target="_blank">gbk2uni</a> 的小工具，用以将 <code>filename.out</code> 中的 GBK 编码的字符转换成八进制数据；刘海洋和李清在 <a href="https://code.google.com/p/ctex-kit/" target="_blank"><code>ctex</code></a> 宏包 / 文档类对此做了处理，使得 <code>ctex</code> 宏包 / 文档类能够正确处理大部分的情况；后来李清编写了 <a href="http://www.ctan.org/pkg/xcjk2uni" target="_blank"><code>xCJK2uni</code></a> 宏包，使得在 pdfLaTeX 编译方式下用 <code>CJK</code> 的 GBK 编码模式也能正确输出 PDF 书签，而不必借用额外的工具。</p>
<p>这里对全部正确的方式做一个总结。</p>
<a id="more"></a>

<h2 id=" 推荐的方式 ">推荐的方式</h2>
<p>最好的办法是将中文支持和版式处理都交给 <code>ctex</code> 宏包 / 文档类，只需要开启 <code>hyperref</code> 选项即可。</p>
<p>适用情况</p>
<ul>
<li>UTF-8 + XeLaTeX（目前<strong>最最最最最最最最</strong>推荐的方式，看到它请星星眼）</li>
<li>UTF-8 + pdfLaTeX</li>
<li>UTF-8 + LaTeX - DVIPDFMx</li>
</ul>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">[</span>hyperref, UTF8<span class="special">]</span><span class="special">{</span>ctexart<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\section</span><span class="special">{</span>中文书签不会乱码<span class="special">}</span>
UTF-8 编码，Xe<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span>/pdf<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span>/<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span> - DVIPDFMx 编译。
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>





<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">[</span>hyperref, UTF8<span class="special">]</span><span class="special">{</span>ctex<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\section</span><span class="special">{</span>中文书签不会乱码<span class="special">}</span>
UTF-8 编码，Xe<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span>/pdf<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span>/<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span> - DVIPDFMx 编译。
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>适用情况（除非必要，不要使用 GBK 编码）</p>
<ul>
<li>GBK + LaTeX - DVIPDFMx</li>
<li>GBK + pdfLaTeX （ctex 宏包 2.x 版本支持，当前的 1.x 版本暂不支持）</li>
</ul>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">[</span>hyperref, GBK<span class="special">]</span><span class="special">{</span>ctexart<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\section</span><span class="special">{</span>中文书签不会乱码<span class="special">}</span>
GBK 编码，pdf<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span>/<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span> - DVIPDFMx 编译。
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>





<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">[</span>hyperref, GBK<span class="special">]</span><span class="special">{</span>ctex<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\section</span><span class="special">{</span>中文书签不会乱码<span class="special">}</span>
GBK 编码，pdf<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span>/<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span> - DVIPDFMx 编译。
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<h2 id=" 折腾星人的方式 ">折腾星人的方式</h2>
<p>如果不想使用 <code>ctex</code> 宏包 / 文档类，也可以选择自己写代码进行中文支持。这时候需要做额外的代码配置，保证 PDF 书签不会乱码。</p>
<p>适用情况</p>
<ul>
<li>UTF-8 + XeLaTeX</li>
</ul>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>xeCJK<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>hyperref<span class="special">}</span>
<span class="command">\setCJKmainfont</span><span class="special">{</span>SimSun<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\section</span><span class="special">{</span>中文书签不会乱码<span class="special">}</span>
UTF-8 编码，Xe<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span> 编译。
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>适用情况</p>
<ul>
<li>UTF-8 + pdfLaTeX</li>
</ul>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>CJKutf8<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>hyperref<span class="special">}</span>
<span class="command">\hypersetup</span><span class="special">{</span>unicode<span class="special">}</span>
<span class="command">\AtBeginShipoutFirst</span><span class="special">{</span><span class="command">\input</span><span class="special">{</span>zhwinfonts.tex<span class="special">}</span><span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>CJK*<span class="special">}</span><span class="special">{</span>UTF8<span class="special">}</span><span class="special">{</span>song<span class="special">}</span>
<span class="command">\section</span><span class="special">{</span>中文书签不会乱码<span class="special">}</span>
UTF-8<span class="special">~</span>编码，pdf<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span><span class="special">~</span>编译。
<span class="command">\clearpage</span>
<span class="command">\end</span><span class="special">{</span>CJK*<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>适用情况</p>
<ul>
<li>UTF-8 + LaTeX - DVIPDFMx</li>
</ul>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>CJKutf8<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">[</span>dvipdfmx<span class="special">]</span><span class="special">{</span>hyperref<span class="special">}</span>
<span class="command">\hypersetup</span><span class="special">{</span>unicode<span class="special">}</span>
<span class="command">\AtBeginShipoutFirst</span><span class="special">{</span><span class="command">\input</span><span class="special">{</span>zhwinfonts.tex<span class="special">}</span><span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>CJK*<span class="special">}</span><span class="special">{</span>UTF8<span class="special">}</span><span class="special">{</span>song<span class="special">}</span>
<span class="command">\section</span><span class="special">{</span>中文书签不会乱码<span class="special">}</span>
UTF-8<span class="special">~</span>编码，<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span> - DVIPDFMx<span class="special">~</span>编译。
<span class="command">\clearpage</span>
<span class="command">\end</span><span class="special">{</span>CJK*<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>适用情况</p>
<ul>
<li>GBK + pdfLaTeX （谁特么还在用 GBK 啊！摔！）</li>
</ul>
<p>请大家将感谢信发送至 <a href="http://www.zhihu.com/people/qinglee" target="_blank">李清</a> 的邮箱~</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>CJK<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>xCJK2uni<span class="special">}</span> <span class="comment">% 请大家将感谢信发送至 李清 的邮箱~ : )</span>
<span class="command">\usepackage</span><span class="special">{</span>hyperref<span class="special">}</span>
<span class="command">\AtBeginShipoutFirst</span><span class="special">{</span><span class="command">\input</span><span class="special">{</span>zhwinfonts.tex<span class="special">}</span><span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>CJK*<span class="special">}</span><span class="special">{</span>GBK<span class="special">}</span><span class="special">{</span>song<span class="special">}</span>
<span class="command">\section</span><span class="special">{</span>中文书签不会乱码<span class="special">}</span>
GBK<span class="special">~</span>编码，pdf<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span><span class="special">~</span>编译。
<span class="command">\clearpage</span>
<span class="command">\end</span><span class="special">{</span>CJK*<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>



<p>适用情况</p>
<ul>
<li>GBK + LaTeX - DVIPDFMx（谁特么还在用 GBK 啊！摔！）</li>
</ul>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre><span class="command">\documentclass</span><span class="special">{</span>article<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">{</span>CJK<span class="special">}</span>
<span class="command">\usepackage</span><span class="special">[</span>dvipdfmx<span class="special">]</span><span class="special">{</span>hyperref<span class="special">}</span>
<span class="command">\hypersetup</span><span class="special">{</span>CJKbookmarks<span class="special">}</span>
<span class="command">\AtBeginShipoutFirst</span><span class="special">{</span><span class="command">\input</span><span class="special">{</span>zhwinfonts.tex<span class="special">}</span><span class="special">}</span>
<span class="command">\AtBeginShipoutFirst</span><span class="special">{</span><span class="command">\special</span><span class="special">{</span>pdf:tounicode GBK-EUC-UCS2<span class="special">}</span><span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>document<span class="special">}</span>
<span class="command">\begin</span><span class="special">{</span>CJK*<span class="special">}</span><span class="special">{</span>GBK<span class="special">}</span><span class="special">{</span>song<span class="special">}</span>
<span class="command">\section</span><span class="special">{</span>中文书签不会乱码<span class="special">}</span>
GBK<span class="special">~</span>编码，<span class="command">\LaTeX</span><span class="special">{</span><span class="special">}</span> - DVIPDFMx<span class="special">~</span>编译。
<span class="command">\clearpage</span>
<span class="command">\end</span><span class="special">{</span>CJK*<span class="special">}</span>
<span class="command">\end</span><span class="special">{</span>document<span class="special">}</span>
</pre></td></tr></table></figure>






]]></content>
    <summary type="html"><![CDATA[<p>LaTeX 的 <code>hyperref</code> 宏包能够在 PDF 文件里生成 PDF 书签，然而「书签乱码」是困扰很多 LaTeX 使用者的麻烦问题。</p>
<p>早年李树钧和张林波老师共同开发了名为 <a href="http://www.hooklee.com/tex/gbk2uni.zip" target="_blank">gbk2uni</a> 的小工具，用以将 <code>filename.out</code> 中的 GBK 编码的字符转换成八进制数据；刘海洋和李清在 <a href="https://code.google.com/p/ctex-kit/" target="_blank"><code>ctex</code></a> 宏包 / 文档类对此做了处理，使得 <code>ctex</code> 宏包 / 文档类能够正确处理大部分的情况；后来李清编写了 <a href="http://www.ctan.org/pkg/xcjk2uni" target="_blank"><code>xCJK2uni</code></a> 宏包，使得在 pdfLaTeX 编译方式下用 <code>CJK</code> 的 GBK 编码模式也能正确输出 PDF 书签，而不必借用额外的工具。</p>
<p>这里对全部正确的方式做一个总结。</p>
]]></summary>
    
      <category term="PDF" scheme="http://liam0205.me/tags/PDF/"/>
    
      <category term="Bookmarks" scheme="http://liam0205.me/tags/Bookmarks/"/>
    
      <category term="CJK" scheme="http://liam0205.me/tags/CJK/"/>
    
      <category term="Error Codes" scheme="http://liam0205.me/tags/Error%20Codes/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[为 MacTeX 配置中文支持]]></title>
    <link href="http://liam0205.me/2014/11/02/latex-mactex-chinese-support/"/>
    <id>http://liam0205.me/2014/11/02/latex-mactex-chinese-support/</id>
    <published>2014-11-02T10:07:28.000Z</published>
    <updated>2015-01-26T07:41:12.000Z</updated>
    <content type="html"><![CDATA[<p>最近有人问到如何在 MacTeX 里配置中文支持，这里一并回答。</p>
<p>目前来说，结合 <code>xeCJK</code> 宏包使用 XeLaTeX 编译，应该是最方便的方式了。</p>
<p>XeLaTeX 要求 <code>.tex</code> 文档保存为 UTF-8 编码。所以要做的事情只有两件：</p>
<ul>
<li>配置一个 UTF-8 的编辑环境；</li>
<li>用 <code>xeCJK</code> 的语法选择合适的字体。</li>
</ul>
<a id="more"></a>

<h2 id=" 配置 _UTF-8_ 的编辑环境 ">配置 UTF-8 的编辑环境</h2>
<p>MacTeX 自带了名为 TeXshop 的编辑器，这里以它为例配置 UTF-8 的编辑环境。其他编辑器也有类似配置。</p>
<p>打开 TeXshop，按下 <code>cmd + ,</code> 打开偏好设置。在「源代码」标签下找到编码设置，调整为 UTF-8。然后单击「好」保存即可。</p>
<p><img src="/attachment/images/MacTeX_xeCJK/01.png" alt=" 调整 TeXshop 的编码 "></p>
<h2 id=" 查找字体信息 ">查找字体信息</h2>
<p>XeTeX 在 Mac OS X 下的行为和 Windows/Linux 下不大一样。Mac 底下，XeTeX 并不使用 <code>fontconfig</code> 库来搜索字体，所以我们没法在终端里通过 <code>fc-list</code> 命令来查看可用的字体列表。不过 Mac 里提供了名为「字体册」的程序，来列出系统中所有可用的字体信息。</p>
<p>其实这样的设计挺讨厌的，TeX Live 自带了许多开源字体，因此没有办法很好地使用。必须用字体名而不是字族名来调用这些字体，实在是不太方便。当然，如果有需要，我们可以把 TeX 里自带的这些开源字体用硬链接的方式，添加到 Mac 的字体目录下。</p>
<p>打开字体册程序，找到需要的字体信息：</p>
<p><img src="/attachment/images/MacTeX_xeCJK/02.png" alt=" 在字体册中查找字体信息 "></p>
<p>这里的 PostScript 名称就是我们需要的信息，我们记下华文宋体的名字：「STSong」。你还可以按需找到其他字体的名字，比如华文中宋、华文楷体、华文黑体等字体的名字。</p>
<h2 id=" 用 _xeCJK_ 的语法配置字体 ">用 xeCJK 的语法配置字体</h2>
<p>使用下列代码，配置中文字体。</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="command">\usepackage</span><span class="special">{</span>xeCJK<span class="special">}</span>
<span class="command">\setCJKmainfont</span><span class="special">[</span>BoldFont=STZhongsong, ItalicFont=STKaiti<span class="special">]</span><span class="special">{</span>STSong<span class="special">}</span>
<span class="command">\setCJKsansfont</span><span class="special">[</span>BoldFont=STHeiti<span class="special">]</span><span class="special">{</span>STXihei<span class="special">}</span>
<span class="command">\setCJKmonofont</span><span class="special">{</span>STFangsong<span class="special">}</span>
</pre></td></tr></table></figure>



<p>这里，</p>
<ul>
<li>文档中文主字体是华文宋体，对应的 bfseries 字体是华文中宋，对应的 itshape 字体是华文楷体；</li>
<li>文档的「无衬线」中文字体是华文新黑，对应的 bfseries 是华文黑体；</li>
<li>文档的「等宽」中文字体是华文仿宋。</li>
</ul>
<p>完整代码的编译效果截图如下：</p>
<p><img src="/attachment/images/MacTeX_xeCJK/03.png" alt=" 编译效果 "></p>
<h2 id=" 额外的工作 ">额外的工作</h2>
<p>尽管这一节的操作有些复杂，而且对于中文支持来说是可选的，但是依旧推荐按步骤操作。</p>
<p><code>xeCJK</code> 之解决了中文支持问题，以及一些关于标点的处理，并没有提供和中文版式相关的解决方案。<code>ctex</code> 宏包和文档类封装了 xeCJK，同时提供了中文版式的相关支持。不过 <code>ctex</code> 的默认配置是为 Windows 平台配置的，Mac 用户需要对默认配置做一些修改。具体如下。</p>
<p>打开终端，键入命令：</p>
<figure class="highlight shell"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="built_in">cd</span> /usr/local/texlive/texmf-local/tex/latex/
<span class="built_in">sudo</span> mkdir ./ctex/
<span class="built_in">sudo</span> mkdir ./ctex/cfg/
<span class="built_in">cd</span> ./ctex/cfg/
<span class="built_in">sudo</span> vim ctexopts.cfg
</pre></td></tr></table></figure>



<p>复制以下内容：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="command">\ExecuteOptions</span><span class="special">{</span>UTF8<span class="special">}</span>
<span class="command">\ExecuteOptions</span><span class="special">{</span>nofonts<span class="special">}</span>

<span class="command">\endinput</span>
</pre></td></tr></table></figure>



<p>切换回到终端窗口，按 <code>i</code> 进入编辑模式，按 <code>cmd + v</code> 粘贴，按 <code>esc</code> 退出编辑模式，输入 <code>:x</code> 保存退出（半角冒号紧接着 x）。<br>在终端窗口继续操作，键入命令：</p>
<figure class="highlight shell"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="built_in">sudo</span> vim ctex.cfg
</pre></td></tr></table></figure>



<p>复制以下内容：</p>
<figure class="highlight tex"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre><span class="command">\RequirePackage</span><span class="special">{</span>ifxetex<span class="special">}</span>
<span class="command">\ifxetex</span>
  <span class="command">\setCJKmainfont</span><span class="special">[</span>BoldFont=STZhongsong, ItalicFont=STKaiti<span class="special">]</span><span class="special">{</span>STSong<span class="special">}</span>
  <span class="command">\setCJKsansfont</span><span class="special">[</span>BoldFont=STHeiti<span class="special">]</span><span class="special">{</span>STXihei<span class="special">}</span>
  <span class="command">\setCJKmonofont</span><span class="special">{</span>STFangsong<span class="special">}</span>

  <span class="command">\newCJKfontfamily</span><span class="special">[</span>stsong<span class="special">]</span><span class="command">\songti</span><span class="special">[</span>BoldFont=STZhongsong, ItalicFont=STKaiti<span class="special">]</span><span class="special">{</span>STSong<span class="special">}</span>
  <span class="command">\newCJKfontfamily</span><span class="special">[</span>sthei<span class="special">]</span><span class="command">\heiti</span><span class="special">[</span>BoldFont=STHeiti<span class="special">]</span><span class="special">{</span>STXihei<span class="special">}</span>
  <span class="command">\newCJKfontfamily</span><span class="special">[</span>stkai<span class="special">]</span><span class="command">\kaishu</span><span class="special">{</span>STKaiti<span class="special">}</span>
  <span class="command">\newCJKfontfamily</span><span class="special">[</span>stfang<span class="special">]</span><span class="command">\fangsong</span><span class="special">{</span>STFangsong<span class="special">}</span>
  <span class="command">\newCJKfontfamily</span><span class="special">[</span>stli<span class="special">]</span><span class="command">\lishu</span><span class="special">{</span>STLiti<span class="special">}</span>
<span class="command">\fi</span>
<span class="command">\endinput</span>
</pre></td></tr></table></figure>



<p>切换回到终端窗口，按 <code>i</code> 进入编辑模式，按 <code>cmd + v</code> 粘贴，按 <code>esc</code> 退出编辑模式，输入 <code>:x</code> 保存退出（半角冒号紧接着 x）。<br>在终端窗口继续操作，键入命令：</p>
<figure class="highlight shell"><figcaption><span>demo </span></figcaption><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="built_in">sudo</span> texhash
</pre></td></tr></table></figure>



<p>这里，</p>
<ul>
<li><code>ctexopts.cfg</code> 会在 <code>ctex</code> 宏包 / 文档类的选项定义之后被载入，我们启用了 <code>nofonts</code> 和 <code>UTF8</code> 这两个选项；</li>
<li><code>ctex.cfg</code> 则会在 <code>ctex</code> 宏包 / 文档类的结尾被载入，我们配置了字体；</li>
<li><code>texhash</code> 会刷新 TeX 的文件名数据库。</li>
</ul>
<p>至此，<code>ctex</code> 宏包 / 文档类在 Mac 里就可以正常工作了。测试截图如下：</p>
<p><img src="/attachment/images/MacTeX_xeCJK/04.png" alt=" 编译效果 "></p>
]]></content>
    <summary type="html"><![CDATA[<p>最近有人问到如何在 MacTeX 里配置中文支持，这里一并回答。</p>
<p>目前来说，结合 <code>xeCJK</code> 宏包使用 XeLaTeX 编译，应该是最方便的方式了。</p>
<p>XeLaTeX 要求 <code>.tex</code> 文档保存为 UTF-8 编码。所以要做的事情只有两件：</p>
<ul>
<li>配置一个 UTF-8 的编辑环境；</li>
<li>用 <code>xeCJK</code> 的语法选择合适的字体。</li>
</ul>
]]></summary>
    
      <category term="CJK" scheme="http://liam0205.me/tags/CJK/"/>
    
      <category term="MacTeX" scheme="http://liam0205.me/tags/MacTeX/"/>
    
      <category term="OS X" scheme="http://liam0205.me/tags/OS%20X/"/>
    
      <category term="LaTeX" scheme="http://liam0205.me/categories/LaTeX/"/>
    
  </entry>
  
</feed>
